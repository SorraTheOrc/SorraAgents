{"data":{"assignee":"@product-owner","createdAt":"2026-01-24T21:31:06.797Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Title: Risk and Effort Edtimator Skill\nPriority: P0\nLabels: P0, feature, spec\nAssignees: @product-owner\n\nDescription\n-----------\nCreate a new \"Risk and Effort\" skill that produces conservative, structured engineering estimates and risk assessments from an issue text. The skill must expose a reliable command to trigger it and must follow the exact output format and constraints below.\n\nTrigger command (suggested)\n---------------------------\nUse a single command that reliably invokes the skill. Suggested CLI command:\n\n`opencode skill run risk-and-effort-edtimator`\n\nDraft prompt (to be embedded in the skill)\n----------------------------------------\nYou are an expert engineering estimator. Your task: review the issue and produce risk and effort estimates using recognized best practices (WBS, three-point/PERT, uncertainty, assumptions, risk matrix).\n\nHard constraints:\n- You must NOT ask any follow-up questions.\n- You must NOT assume access to code, repo, logs, or stakeholders.\n- You must work ONLY with the content inside <system-reminder> (treat it as the full issue context). If details are missing, call them out explicitly and choose conservative estimates.\n\nWhat to do:\n1) Restate the issue in 1–2 sentences (to prove understanding).\n2) Identify scope boundaries:\n   - In scope\n   - Out of scope\n3) Build a lightweight work breakdown (WBS) with 5–12 items (design, implementation, tests, docs, rollout, monitoring), noting likely dependencies and unknowns.\n4) Effort estimate (use three-point estimating / PERT):\n   - Provide Optimistic (O), Most Likely (M), Pessimistic (P) in “ideal engineering days” (or hours if very small).\n   - Compute Expected (E) = (O + 4M + P) / 6.\n   - Add “coordination overhead” and “risk buffer” explicitly if warranted (don’t hide it).\n   - Provide a final range (min–max) and a single recommended planning value.\n   - Also provide a T-shirt size (XS/S/M/L/XL) with clear thresholds you define.\n5) Risk estimate (use a probability x impact matrix):\n   - Score Probability (1–5) and Impact (1–5).\n   - Overall Risk Score = Probability * Impact (1–25) and map to: Low (1–5), Medium (6–12), High (13–19), Critical (20–25).\n   - Break risk into categories with 1–2 bullets each: Technical, Product/Requirements, Delivery/Dependencies, Operational/Performance, Security/Compliance.\n   - Include top 3 risk drivers and the best mitigation for each.\n6) Confidence:\n   - Provide confidence % (0–100) with a one-line justification referencing missing info/uncertainty.\n7) If the issue is underspecified, propose a “spike” option:\n   - Spike goal, timebox, and how it would reduce uncertainty (and how estimates would change).\n\nOutput format\n-------------\n- First: a compact JSON block with keys exactly:\n  - effort: { \"unit\": \"ideal_days\", \"tshirt\": \"\", \"o\": 0, \"m\": 0, \"p\": 0, \"expected\": 0, \"recommended\": 0, \"range\": [0,0] }\n  - risk: { \"probability\": 0, \"impact\": 0, \"score\": 0, \"level\": \"\", \"top_drivers\": [], \"mitigations\": [] }\n  - confidence_percent: 0\n  - assumptions: []\n  - unknowns: []\n- Then: a brief narrative (bulleted) explaining the reasoning, WBS, and what would most change the estimates.\n\nIntegration details / constraints\n--------------------------------\n- The skill must accept an input block called <system-reminder> and must use only that content to produce estimates.\n- The skill must never ask follow-up questions; if information is missing it should explicitly list unknowns and choose conservative estimates.\n- The produced JSON must match the key names and types exactly to allow programmatic consumption.\n\nAcceptance criteria\n-------------------\n- Running `opencode skill run risk-and-effort-edtimator` with an input issue containing a <system-reminder> block returns a valid JSON block followed by the narrative.\n- JSON validates against the shape described above and numbers are realistic (non-negative, expected computed correctly).\n- The narrative includes a 5–12 item WBS and top 3 risk drivers with mitigations.\n\nSuggested next steps\n--------------------\n1. Create a GitHub issue from this file (title: \"Risk and Effort Edtimator Skill\").\n2. Add labels: `P0`, `feature`, `spec`.\n3. Assign a product owner (@product-owner) and link to this worklog file.\n4. Implement the skill (prototype using the draft prompt); expose the CLI command `opencode skill run risk-and-effort-edtimator`.\n5. Write automated tests validating JSON output shape and example estimates for 2–3 representative issues.\n\nNotes\n-----\n- This is a top-level P0 issue describing the desired new skill and the exact estimation output format required from the skill.\n- The skill must be conservative by default and must flag missing info rather than inventing it.","effort":"L","githubIssueId":3852122460,"githubIssueNumber":3,"githubIssueUpdatedAt":"2026-01-24T21:37:58Z","id":"SA-0MKSTQR3H1HLD7HC","issueType":"","parentId":"SA-0MKYVWAKU14W795Z","priority":"high","risk":"High","sortIndex":0,"stage":"in_review","status":"completed","tags":["P0","feature","spec"],"title":"Risk and Effort Estimator Skill","updatedAt":"2026-01-29T10:18:49.133Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-28T09:59:22Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"When running an implementation command that explicitly instructs the agent not to ask any questions or stop, the agent still created a Product Requirements Document (PRD). This is unexpected behavior: implementation commands should perform the requested changes without generating a PRD or asking for clarification.\\n\\nSteps to reproduce:\\n1. Run an implementation command with instructions like: 'do not ask questions or stop; just implement.'\\n2. Observe that the agent generates a PRD instead of proceeding directly to implementation.\\n\\nImpact: This breaks workflows that rely on hands-off implementation runs and can add unnecessary work or delays.\\n\\nRequested: Investigate why the agent produced a PRD despite the directive not to ask questions or stop, and update the implementation flow so it respects the 'no questions' directive.","effort":"","githubIssueId":3864593580,"githubIssueNumber":4,"githubIssueUpdatedAt":"2026-01-28T09:59:22Z","id":"SA-0MKXUZ3UP091UX0H","issueType":"","parentId":null,"priority":"high","risk":"","sortIndex":0,"stage":"","status":"deleted","tags":["stage:idea"],"title":"implementation command requires a PRD","updatedAt":"2026-01-28T10:11:19.929Z"},"type":"workitem"}
{"data":{"assignee":"Map","createdAt":"2026-01-28T10:14:38.518Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Orchestration is the ability to run multiple agent teams against multiple tasks within the same project at the same time.","effort":"","id":"SA-0MKXVC7NA0UQLDR7","issueType":"","parentId":null,"priority":"medium","risk":"","sortIndex":0,"stage":"idea","status":"in_progress","tags":[],"title":"Orchestration","updatedAt":"2026-01-29T22:31:15.810Z"},"type":"workitem"}
{"data":{"assignee":"Map","createdAt":"2026-01-28T10:28:04.339Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"<!-- MILESTONES:START -->\nMilestones (generated):\n1. Spec & Design — SA-0ML4EDHTD09ZZD7Y\n2. Detection Engine — SA-0ML4EE9NH05OG9TI\n3. Dependency Recording — SA-0ML4EE9SQ1I39EZ3\n4. Idempotence & Reporting — SA-0ML4EE9X61I5IPEE\n5. Integration Tests — SA-0ML4EEA1U1FNKN7E\n6. Docs, Templates & Rollout — SA-0ML4EEA6I13ZXT7F\n<!-- MILESTONES:END -->","effort":"","id":"SA-0MKXVTHF70EXG01D","issueType":"","parentId":"SA-0MKXVC7NA0UQLDR7","priority":"medium","risk":"","sortIndex":0,"stage":"milestones_defined","status":"in_progress","tags":[],"title":"Swarmable Plans","updatedAt":"2026-02-01T23:54:46.740Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-28T11:33:34.586Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"When running any task agents will often stop to ask a question. They will offer options and recommend on. Can we make Build consider the three options and answer the question? If not can we make worklog spawn another session, get the answer and return that to the agent? We could mock this latter solution by simply having them answer every question with 'do what you think is best' or similar.","effort":"","id":"SA-0MKXY5Q0Q1UW4P5T","issueType":"","parentId":"SA-0MKXVC7NA0UQLDR7","priority":"medium","risk":"","sortIndex":0,"stage":"idea","status":"open","tags":[],"title":"Build to keep Patch going","updatedAt":"2026-01-28T11:34:09.362Z"},"type":"workitem"}
{"data":{"assignee":"Map","createdAt":"2026-01-28T11:47:52.613Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Scope\n-----\nThis work item focuses on ensuring agents reliably create agent-specific worktrees and branches, persist their work there, and make that work visible across worktrees using the existing Worklog CLI (`wl`) and repo conventions. No changes will be made to Worklog core code in this work item. If the integration tests reveal a Worklog product issue, we will file GitHub issues describing repro steps and suggested fixes.\n\nPrimary deliverable\n-------------------\nAn agent skill (code + tests + docs) that: creates a named agent worktree `<agent-name>-<DD-MM-YY-HH-MM>`, creates/checks-out a branch using the repository convention (see `command/implement.md`), commits changes, invokes `wl sync`, and demonstrates that another worktree can see the branch and commit after `wl sync`.\n\nSuccess criteria\n----------------\n- The agent skill can be invoked in an ephemeral environment and creates a worktree, creates/checks-out an appropriate branch, commits, and runs `wl sync` without requiring Worklog core changes.\n- An integration test harness runs two or more ephemeral worktrees: Agent A runs the skill and `wl sync`; Agent B runs `wl sync` and can see Agent A's branch and commit (matching commit hash and files). Tests must include a basic concurrent-commit detection scenario and record reproducible logs.\n- All deliverables include tests, usage docs, and a runbook for triage. When tests surface a Worklog core gap, a GitHub issue with repro steps, logs, and suggested options will be filed.\n\nOut of scope\n------------\n- Modifying Worklog core source code. Instead, create GitHub issues for product changes.\n- SDK changes (these will be considered separately outside this work item).\n- Large RBAC/permissions redesigns. If required, file issues and document the required changes.\n\nDeliverables\n------------\n- `agents/skills/create-worktree-skill/` — agent skill code, unit tests, small example harness demonstrating the happy path.\n- `tests/integration/agent-worktree-visibility.sh` — integration harness that runs ephemeral worktrees and asserts visibility.\n- `docs/agents-worktrees.md` and `docs/runbook-agent-conflicts.md` — usage, troubleshooting, and GH issue template for reporting product gaps.\n\nRelated work\n------------\nParent epic: SA-0MKXVC7NA0UQLDR7 (Orchestration)\nRelated items: SA-0MKXVTHF70EXG01D (Swarmable Plans), SA-0MKXY5Q0Q1UW4P5T (Build to keep Patch going)\n\nNotes\n-----\n- Branch/worktree conventions: follow `command/implement.md` in this repository for naming and lifecycle rules.\n- Backwards compatibility is not required.\n- This item is currently `in_progress` at stage `intake_complete`; I will not change the stage without explicit instruction.\n\n\"Plan: changelog\"\n------------------\n- 2026-01-29T23:10Z: Updated description to focus scope on agent skill + tests + docs; no code changes to Worklog core. --agent: OpenCode","effort":"","id":"SA-0MKXYO42T0FC6IJR","issueType":"","parentId":"SA-0MKXVC7NA0UQLDR7","priority":"critical","risk":"","sortIndex":0,"stage":"in_review","status":"completed","tags":[],"title":"Isolated work environments for parallel work","updatedAt":"2026-01-31T00:11:52.016Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-28T19:00:09.196Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Problem: Agents report that the CLI command  does not exist when running the  command (typo in command name).\\n\\nContext:\\n- Multiple agents invoking  surface an error that  is unknown.\\n- This prevents threads/contexts from being displayed and blocks agents from continuing automated flows.\\n\\nGoal:\\nInvestigate why  is missing (typo vs missing implementation), implement  or update callers to the correct flag, and add tests and docs so agents can reliably call it.\\n\\nSteps to reproduce:\\n1) Run the agent automation that triggers  (or call the same code path).\\n2) Observe the agent logs: error showing  does not exist.\\n\\nSuggested investigation path:\\n- Search command dispatcher for  handling and for usages of .\\n- Check CLI command registry and the  subcommands implementation.\\n- Determine whether the intended flag is  (new feature) or / (existing) or a typo in  usage.\\n- Implement  (or alias) if missing and add unit tests.\\n- Update agents that call  if they use the wrong call.\\n\\nAcceptance criteria:\\n- Agents invoking  no longer log a missing-command error for .\\n-  is implemented or callers updated; CLI tests cover the behavior.\\n- Add or update agent integration tests that exercise the  flow.\\n- Add a short note to the developer docs describing the  usage and the  flow.","effort":"","id":"SA-0MKYE40VG1V2DTOX","issueType":"bug","parentId":"SA-0MKYVWAKU14W795Z","priority":"high","risk":"","sortIndex":0,"stage":"in_review","status":"completed","tags":[],"title":"Agent error: 'wl show --thread' missing when running /impplement","updatedAt":"2026-01-29T18:19:00.410Z"},"type":"workitem"}
{"data":{"assignee":"Map","createdAt":"2026-01-28T19:00:23.307Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Problem statement\n---------------\nAgents sometimes encounter failing tests during automated work that originate in code they do not own. There is no consistent, automated process for detecting whether an existing critical work item already captures that failure, creating a critical issue when needed, and recording blocking relationships — which leads to duplicated effort, lost signal, and stalled work.\n\nUsers\n-----\n- Agents (automation) that run tests and make code changes — need a clear, predictable triage flow when they see external failures.\n- Developers/owners of failing code — get consistent, reproducible bug reports with repro steps and CI evidence.\n- PMs / on-call / triage roles — need each critical failure assigned and tracked to resolution so work capacity is not wasted.\n\nSuccess criteria\n----------------\n- When an agent detects a failing test it does NOT own, it automatically searches worklog for an existing open critical issue matching the failure. If none exists, the agent creates one (title + test name + failing output + reproduction steps + suspected owners). (Automation verified by unit/integration tests.)\n- Other work may continue locally, but the existence of any open critical work item blocks creation or merging of any PR (regardless of whether the PR's work item is explicitly recorded as blocked), except for PRs that are intended to close a critical issue and explicitly reference that critical issue ID.\n- Any created critical issue uses the agreed minimal template and is assigned or flagged for triage within X minutes (configurable). Tests validate issue content and linking behavior.\n\nConstraints\n-----------\n - Agents must have permission to create and update work items in wl and to access CI artifacts/links if available.\n- The matching heuristics must be conservative to avoid false positives; agents must not overwrite existing issue fields.\n- The policy must not block non-PR local work; blocking applies only to PR creation/merges as specified.\n\nExisting state\n--------------\n- Current work item: SA-0MKYE4BRF1U5WZLK (this intake) records the seed intent and high-level suggested implementation.\n- Implementation guidance and agent flows reference test-fix requirements in `command/implement.md` (mentions “Fix any failing tests before continuing”).\n- `AGENTS.md` documents dependency tags like `blocked-by:<work-item-id>` which this policy will use for linking.\n- Related operational items: SA-0MKYE40VG1V2DTOX (wl show --thread bug) and SA-0MKYE4G3M0B67053 (PM periodic critical-check) — both are related processes to coordinate with.\n\nDesired change\n--------------\n- Add a helper library/function in the agent toolkit, `check_or_create_critical_issue(failure_signature, evidence)` that:\n  - searches wl for matching open critical issues using default heuristics (title + test name + `test-failure` tag + recent timestamp window),\n  - if found, returns the matching issue id; if not found, creates a critical work item using the minimal template and returns the new id.\n - Update agent workflows to call the helper when detecting external failing tests and then:\n  - prevent creation/merge of PRs for any work item while any open critical issue exists, except for PRs that are intended to close a critical issue and explicitly reference that critical issue ID.\n- Add unit tests for the helper, and an integration test that simulates an agent finding a failing test and confirms the correct WL interactions (search, create, link).\n- Add a short runbook and a template for the created critical issues.\n\nMatching heuristics (default)\n----------------------------\n- Match existing critical issues using these checks (in order):\n  1. Exact test name + `test-failure` tag + open status within the last 72 hours.\n  2. Title similarity (token overlap) with test name and matching stacktrace top-frame.\n  3. CI job URL or failing commit hash matches an open critical issue.\n- If multiple candidates match, prefer the most recent open issue; if ambiguity remains, attach a comment to the most recent candidate and alert triage.\n\nCritical issue template (minimal required fields)\n-----------------------------------------------\n- Title: `[test-failure] <test-name> — <short-failure-summary>`\n- Body fields (required):\n  - Test name\n  - Failing output / short stderr snippet\n  - Reproduction steps (may be multi-step; must be sufficient for a developer to re-run the failure)\n  - Suspected owner(s) or area labels (if detectable)\n  - Failing commit hash (if available)\n  - Attach logs or link to an archive if larger than inline limits\n\nRelated work\n------------\n- `command/implement.md` — agent guidance mentioning test-fix expectations (path: `command/implement.md`).\n- `AGENTS.md` — dependency tagging and conventions (path: `AGENTS.md`).\n- SA-0MKYE40VG1V2DTOX — `Agent error: 'wl show --thread' missing when running /impplement` (operational bug to coordinate with). \n- SA-0MKYE4G3M0B67053 — `PM duty: periodic check for critical issues and immediate assignment` (process for assignment/triage).\n\nAcceptance criteria (detailed)\n-----------------------------\n1. Automated tests: unit tests for `check_or_create_critical_issue` covering match, create, and conflict resolution; one integration test that simulates an agent run creating or linking to a critical issue and marking WIP linked/updated.\n2. When an agent detects an external failing test, it automatically searches and creates a critical issue per the template if none exists. The created issue is priority `critical`, tagged `test-failure`, and includes required fields (including reproduction steps).\n3. When an agent finds an existing critical issue it should update/improve the issue description with any new information discovered from the failure. Creation or merging of any PR is blocked while any critical issue remains open, except for PRs that explicitly aim to close a critical issue and reference its id in the PR description.\n4. A short runbook and template file are added to the repo (path: `/.opencode/triage/test-failure-template.md`) describing fields and triage steps.\n\nRisks & mitigations\n--------------------\n- Risk: False positives — a matching heuristic may incorrectly match unrelated failures, causing unnecessary blocking.\n  - Mitigation: Conservative heuristics (exact test name + `test-failure` tag + 72h window) and prefer recent issues; provide an override path for humans to un-block when needed.\n- Risk: Flaky tests cause noise and frequent critical issues.\n  - Mitigation: Add optional CI re-check or a flakiness score; include flakiness flag in issues and route to a separate triage queue.\n- Risk: Agents lack permissions to read CI metadata or create issues.\n  - Mitigation: Add a startup check that verifies required permissions and fails fast with a clear error message.\n\n\n\nNotes / Open questions\n----------------------\n- Do you want the agent to re-run CI automatically (flaky-check) before creating a critical issue? Current default: no — agents create issues immediately on deterministic failures; CI re-check could be added as an enhancement. \n- Who should be the default assignee or triage role for newly-created critical issues (e.g., `@oncall`, `@pm`, or leave unassigned)? Current draft requires triage within a configurable time window but does not auto-assign a specific person by default.","effort":"","id":"SA-0MKYE4BRF1U5WZLK","issueType":"feature","parentId":"SA-0MKYVWAKU14W795Z","priority":"medium","risk":"","sortIndex":0,"stage":"plan_complete","status":"in_progress","tags":[],"title":"Agent policy: create/check critical issue when encountering failing tests not owned","updatedAt":"2026-01-29T19:48:56.045Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-28T19:00:28.930Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Problem: Critical issues can remain unaddressed if not actively monitored, leading to blocked work and production risk.\\n\\nGoal:\\nAdd a periodic process for the PM role to scan for open critical issues and ensure one is actively assigned for resolution. When a critical issue exists: 1) Immediately assign an available agent to resolve it. 2) Do not assign new work items to agents until the critical issue is resolved (to preserve capacity).\\n\\nSuggested implementation:\\n- Add a scheduled job (cron or periodic wl task) run by the PM agent every N minutes (choose default 15m).\\n- The job queries No work items found and if any are found:\\n  - If none are assigned, pick an agent with capacity (based on No in-progress work items found counts or a simple round-robin) and assign the issue.\\n  - If an issue is open and assigned, ensure agents are not scheduled for new work until the issue is closed. This can be done by tagging agents as  or by modifying the \nRisk and Effort Estimator Skill SA-0MKSTQR3H1HLD7HC\nStatus: open · Stage: plan_complete | Priority: high\nRisk: High\nEffort: L\nAssignee: @product-owner\nTags: P0, feature, spec\n\n## Reason for Selection\nHighest priority (high) and oldest open item\n\nID: SA-0MKSTQR3H1HLD7HC recommendation to prefer critical issues.\\n- Add configuration for frequency and assignment policy, and a short runbook for the PM.\\n\\nAcceptance criteria:\\n- A scheduled PM job exists that checks for critical issues periodically.\\n- When a critical issue exists and is unassigned, the job assigns an agent and comments on the work item.\\n- The system prevents assigning new non-critical work to agents while a critical issue is open (either by tagging agents or influencing \nRisk and Effort Estimator Skill SA-0MKSTQR3H1HLD7HC\nStatus: open · Stage: plan_complete | Priority: high\nRisk: High\nEffort: L\nAssignee: @product-owner\nTags: P0, feature, spec\n\n## Reason for Selection\nHighest priority (high) and oldest open item\n\nID: SA-0MKSTQR3H1HLD7HC).\\n- Add tests for the scheduler logic and updated \nRisk and Effort Estimator Skill SA-0MKSTQR3H1HLD7HC\nStatus: open · Stage: plan_complete | Priority: high\nRisk: High\nEffort: L\nAssignee: @product-owner\nTags: P0, feature, spec\n\n## Reason for Selection\nHighest priority (high) and oldest open item\n\nID: SA-0MKSTQR3H1HLD7HC behavior or assignment guard.","effort":"","id":"SA-0MKYE4G3M0B67053","issueType":"chore","parentId":"SA-0MKYVWAKU14W795Z","priority":"medium","risk":"","sortIndex":0,"stage":"","status":"open","tags":[],"title":"PM duty: periodic check for critical issues and immediate assignment","updatedAt":"2026-01-29T03:21:23.096Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-29T03:18:01.615Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Functionality and processes that define how projects are delivered with AI assistance","effort":"","id":"SA-0MKYVWAKU14W795Z","issueType":"epic","parentId":null,"priority":"medium","risk":"","sortIndex":0,"stage":"","status":"open","tags":[],"title":"Workflow","updatedAt":"2026-01-29T03:18:01.615Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-29T18:49:05.608Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"The intake command is including suggested next steps in the plan itself. This content should not be included.","effort":"","id":"SA-0MKZT5NIF19BLRLH","issueType":"","parentId":null,"priority":"low","risk":"","sortIndex":100,"stage":"idea","status":"open","tags":[],"title":"Exclude next steps from issue descriptions","updatedAt":"2026-02-02T05:26:56.782Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-29T19:48:19.798Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Problem\n-------\nWorkflow currently has no automated mechanism for agents or plugins to install their own skills. We need a small, idempotent installer script that copies skill plugin files into the target Workflow skills directory and performs basic validation and registration steps.\n\nUser story\n----------\nAs an agent integrator, I want an automated installer script so that deploying an agent skill to a developer's Workflow environment is repeatable, idempotent, and requires minimal manual setup.\n\nScope\n-----\nCreate a standalone installer (shell wrapper + Python helper) that:\n- Installs skill files into the Workflow skills directory (default: \"$HOME/.config/opencode/skills\").\n- Validates required files and structure (skill manifest, entrypoint, metadata).\n- Verifies file permissions and ownership are correct for the local user.\n- Provides an uninstall/rollback path that removes copied files without touching other user files.\n- Emits a machine-readable install report (JSON) listing installed files, checksums, backup path (if any), timestamp, and success/failure state.\n\nAcceptance Criteria\n-------------------\n- The installer copies a given skill directory to the target location and ensures files are present with correct permissions.\n- Running the installer twice is idempotent and does not duplicate files or corrupt existing skills.\n- The installer can optionally back up an existing skill before overwriting and can restore the backup on failure.\n- The installer validates presence of a manifest (`skill.yaml` or `manifest.json`) and a declared entrypoint; returns error if missing.\n- The installer produces a machine-readable JSON report with checksums and install status.\n- Basic unit tests cover happy path, idempotence (double-run), and failure/rollback scenarios.\n\nImplementation notes\n--------------------\n- Script: `scripts/skill-installer/install_skill.sh` (POSIX shell wrapper).\n- Helper: `scripts/skill-installer/install_skill.py` (Python 3.8+ implementation).\n- Default target: `$HOME/.config/opencode/skills`, overridable with `--target`.\n- Idempotence: compare sha256 checksums and use atomic replace (install to temp then move) to avoid partial installs.\n- Backup: move existing skill to timestamped `.bak` folder before installing; record backup path in JSON report.\n- Validation: require `skill.yaml` or `manifest.json` and an entrypoint file (`index.js`/`main.py` or manifest field).\n- Tests: `test/skill-installer/*` unit + integration tests; integration uses a temp directory for target.\n- Security: installer does not execute code from skill files. Warn and refuse to run as root unless `--force-root`.\n\nDeliverables\n------------\n- `scripts/skill-installer/install_skill.sh`\n- `scripts/skill-installer/install_skill.py`\n- `scripts/skill-installer/README.md` with usage and security notes\n- Tests under `test/skill-installer/`\n- WL task listing manual verification steps and required permissions\n\nTasks to create\n----------------\n- Implement installer script & helper\n- Add unit tests and integration tests\n- Add README and usage docs\n- Add sample skill and run integration test locally\n\nNotes\n-----\n- This task was created to support automated installation of the agent skills introduced in this plan. The installer must be idempotent and safe for local developer environments.","effort":"","id":"SA-0MKZV9TXY1G4UGRS","issueType":"","parentId":"SA-0MKYE4BRF1U5WZLK","priority":"medium","risk":"","sortIndex":100,"stage":"idea","status":"open","tags":[],"title":"skill-installer: automated installer for agent skills","updatedAt":"2026-01-29T19:54:34.254Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-29T19:48:36.205Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary\n-------\nAgent skill that, given a failure signature and local test evidence, searches WL for matching open critical issues and creates a new critical issue (using standard template) when none exists. Ensures idempotence (72-hour window), attaches structured evidence, and returns the issue id.\n\nAcceptance Criteria\n-------------------\n- The skill returns an existing open critical issue id if a conservative match is found (exact test name + `test-failure` tag + open status within 72h), otherwise it creates a new issue using the triage template and returns its id.\n- Created issues include: failure signature, local test output excerpt, reproduction steps, suspected owner (from owner_inference skill or `Build`), and a link to the runbook.\n- Repeated calls for the same signature within 72 hours do not create duplicates.\n- The skill logs structured telemetry events: `triage.issue.matched`, `triage.issue.created`, `triage.issue.enhanced`.\n- Unit tests cover match/create/duplicate behavior; an integration test simulates local test output and stubbed WL responses.\n\nMinimal Implementation\n----------------------\n- Location: `agent/skills/triage/check_or_create_critical_issue.(ts|py)`\n- Use WL CLI/API for `wl list`, `wl create`, and `wl comment` operations. Prefer a small WL client wrapper in the agent toolkit.\n- Validate evidence input (test name, stdout excerpt, stack trace). Store evidence as an attachment or in the issue body.\n- Implement idempotence via signature hash + recent timestamp window (72h).\n- Emit telemetry and return structured result `{ issueId, created, matchedId?, reason }\n\nDependencies\n------------\n- WL create/list/comment permissions\n- Owner inference skill\n- Templates & runbook files in `.opencode/triage`\n\nDeliverables\n------------\n- Skill source, unit + integration tests, sample invocation docs, telemetry events definition, and example WL calls used in tests.\n\nTasks to create\n---------------\n- Implement skill\n- Add unit tests\n- Add integration scenario\n- Add example usage in `docs/triage.md`","effort":"","id":"SA-0MKZVA6LP07BA8QV","issueType":"","parentId":"SA-0MKYE4BRF1U5WZLK","priority":"medium","risk":"","sortIndex":200,"stage":"idea","status":"open","tags":[],"title":"check_or_create_critical_issue: triage skill","updatedAt":"2026-01-29T19:54:40.165Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-29T19:48:38.390Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary\n-------\nAgent-only skill that creates pull requests after running policy checks. The skill enforces that PRs are not created if a matching open critical test-failure issue exists unless the PR references and closes that issue. Agents are blocked from using `gh` or the GitHub API directly — this skill is the only approved path.\n\nAcceptance Criteria\n-------------------\n- Calling the skill with PR metadata (title, body, branch, reviewers) will either create a PR or return a blocking error explaining the blocking issue and how to proceed.\n- If an open critical issue matches the repo/branch and the PR body does not reference/close it, the skill refuses to create the PR and returns an error with links to the issue and runbook.\n- The skill supports an explicit `force` flag for human-run invocations when the caller has the `triage.override` permission; agent callers may never use `force`.\n- Tests simulate agent callers and assert agents cannot create PRs when blocking issues exist; tests also assert that human callers with `triage.override` can use `force`.\n\nMinimal Implementation\n----------------------\n- Location: `agent/skills/pr/create.(ts|py)`\n- Flow: validate input → call `check_or_create_critical_issue` to detect blocking issues → if blocked, return structured error else proceed to create PR via controlled adapter (which is only callable by the skill when running under user credentials or with explicit human approval).\n- The skill must log telemetry events: `pr.create.attempt`, `pr.create.blocked`, `pr.create.created`.\n\nDependencies\n------------\n- `check_or_create_critical_issue` skill\n- WL access to lookup blocking issues\n- An adapter to create PRs that humans can run (the skill provides instructions or returns a URL for manual PR creation) — agents must not be given gh credentials.\n\nDeliverables\n------------\n- Skill source, tests for agent vs human flows, documentation for required ACL changes and policy enforcement, and example outputs for blocked and successful PR attempts.","effort":"","id":"SA-0MKZVA8AD1JXOYKI","issueType":"","parentId":"SA-0MKYE4BRF1U5WZLK","priority":"medium","risk":"","sortIndex":300,"stage":"idea","status":"open","tags":[],"title":"pr:create: agent-only PR creation skill","updatedAt":"2026-01-29T19:54:45.862Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-29T19:48:40.684Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary\n-------\nAdd repository triage artifacts and a skill to validate/sync them. Files to add:\n- `.opencode/triage/test-failure-template.md`\n- `.opencode/triage/runbook-test-failure.md`\n\nAcceptance Criteria\n-------------------\n- Template includes sections: `## Failure Signature`, `## Evidence`, `## Steps To Reproduce`, `## Impact`, `## Suggested Triage Steps`, `## Links`.\n- Runbook documents owner inference heuristics, triage steps, PR unblock steps, and owner fallback to `Build`.\n- Skill `agent/skills/triage/sync_templates.(ts|py)` validates presence and updates files if out-of-date.\n- Sample `wl create` invocation using the template produces a correctly formatted work item.\n\nMinimal Implementation\n----------------------\n- Add the two files to repo and implement a small skill to validate them.\n- Provide example usage in `docs/triage.md`.\n\nDeliverables\n------------\n- Two repo files, `agent/skills/triage/sync_templates.(ts|py)`, and docs.","effort":"","id":"SA-0MKZVAA241KMKH45","issueType":"","parentId":"SA-0MKYE4BRF1U5WZLK","priority":"medium","risk":"","sortIndex":400,"stage":"idea","status":"open","tags":[],"title":"triage: templates and runbook + sync skill","updatedAt":"2026-01-29T19:54:50.071Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-29T19:48:42.785Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary\n-------\nSkill to infer a suspected owner for a failing test using heuristics: CODEOWNERS, git blame, recent commit history, and an override map. Returns `{ assignee, confidence }` and falls back to `Build` when confidence < threshold.\n\nAcceptance Criteria\n-------------------\n- The skill returns an assignee alias and confidence score (0.0–1.0).\n- Uses CODEOWNERS if present, otherwise uses blame on failing file, then fallback to recent commit authorship.\n- Supports an overrides file `.opencode/triage/owner-map.yaml` for special mappings.\n- Unit tests for CODEOWNERS parse, blame heuristic, overrides, and fallback behavior.\n\nMinimal Implementation\n----------------------\n- Location: `agent/skills/owners/infer_owner.(ts|py)`\n- Expose an API: `infer_owner({ repoPath, filePath, commit }) -> { assignee, confidence, reason }`.\n- Allow tuning the confidence threshold via config.\n\nDeliverables\n------------\n- Skill source, owner-map example file, unit tests, and docs.","effort":"","id":"SA-0MKZVABOH1I8OLXA","issueType":"","parentId":"SA-0MKYE4BRF1U5WZLK","priority":"medium","risk":"","sortIndex":500,"stage":"idea","status":"open","tags":[],"title":"owner_inference: owner detection skill","updatedAt":"2026-01-29T19:54:55.098Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-29T19:48:44.650Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary\n-------\nSkill and harness to run local test suites, produce standardized evidence for triage, and validate the end-to-end policy flow (issue creation, idempotence, PR create blocking).\n\nAcceptance Criteria\n-------------------\n- Harness can run the local test suite and produce structured evidence consumed by `check_or_create_critical_issue`.\n- Integration tests simulate agent flows (issue create, matching, PR create blocked) and assert expected behavior.\n- Tests emit telemetry events and produce a report summarizing pass/fail of policy checks.\n\nMinimal Implementation\n----------------------\n- Location: `agent/skills/tests/harness.(ts|py)` and `test/triage/*` for integration tests.\n- Provide a CLI entrypoint that runs tests and writes structured evidence JSON to stdout/file.\n\nDeliverables\n------------\n- Harness code, integration tests, sample evidence files, and telemetry events spec.","effort":"","id":"SA-0MKZVAD4A119KO4I","issueType":"","parentId":"SA-0MKYE4BRF1U5WZLK","priority":"medium","risk":"","sortIndex":600,"stage":"idea","status":"open","tags":[],"title":"tests_and_policy_validation: test harness skill","updatedAt":"2026-01-29T19:55:01.084Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-30T00:20:40.239Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"An agent skill that creates an agent-specific worktree named '<agent-name>-<DD-MM-YY-HH-MM>', creates/checks-out a branch following the repo convention (feature/SA-<id>-<short>), commits changes, and invokes 'wl sync' to persist state.\n\n## Acceptance Criteria\n- The skill can be invoked in an ephemeral environment and creates a named worktree and branch, makes a commit, and runs 'wl sync' without requiring Worklog core changes.\n- After Agent A runs the skill and 'wl sync', Agent B (in a separate ephemeral worktree) running 'wl sync' sees Agent A's branch and commit (commit hash and file contents match).\n- The skill includes unit tests for its core operations and an integration example demonstrating the happy path.\n\n## Minimal implementation\n- Implement the skill as a small, idempotent script/module (POSIX shell, Node, or Python) under .\n- The skill must: (1) create a worktree (using git worktree or the -recommended flow in ), (2) create/checkout , (3) write a sample file and commit, (4) run Starting sync for /home/rogardle/.config/opencode/.worklog/worklog-data.jsonl...\nLocal state: 20 work items, 8 comments\n\nPulling latest changes from git...\nRemote state: 20 work items, 8 comments\n\nMerging work items...\nMerging comments...\n\nSync summary:\n  Work items added: 0\n  Work items updated: 1\n  Work items unchanged: 19\n  Comments added: 0\n  Comments unchanged: 8\n  Total work items: 20\n  Total comments: 8\n\nMerged data saved locally\n\nPushing changes to git...\nChanges pushed successfully\n\n✓ Sync completed successfully and surface success/failure.\n- Provide a minimal harness that can be invoked by the integration tests.\n\n## Deliverables\n-  with skill code, unit tests, and a short example harness.\n- README snippet showing invocation and expected outputs.\n\n## Notes\n- Use  to help author and scaffold the skill where appropriate.\n- Follow branch/worktree naming conventions defined in .\n- Do not modify Worklog core; if tests expose a bug, file a GitHub issue with repro steps and attach logs.","effort":"","id":"SA-0ML0502B21WHXDYA","issueType":"feature","parentId":"SA-0MKXYO42T0FC6IJR","priority":"medium","risk":"","sortIndex":100,"stage":"in_review","status":"completed","tags":[],"title":"Agent skill: create worktree and branch","updatedAt":"2026-01-30T23:55:20.354Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-01-30T00:20:43.899Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Integration harness that spawns two ephemeral worktrees, runs the agent skill in worktree A, runs 'wl sync' in both worktrees, and asserts that worktree B sees worktree A's branch and commit. Includes a conflict/detection scenario test.\n\nAcceptance Criteria:\n- Harness runs two cloned worktrees in .worklog/tmp-worktree-*; after running the skill in A and syncing, B sees the branch and commit.\n- Conflict scenario: both agents commit then sync; harness asserts Worklog's documented conflict behaviour is observed and logs artifacts.\n\nDeliverables:\n- tests/integration/agent-worktree-visibility.sh (or pytest equivalent)\n- Fixtures and instructions to run locally","effort":"","id":"SA-0ML05054Q0S4KAUD","issueType":"task","parentId":"SA-0MKXYO42T0FC6IJR","priority":"medium","risk":"","sortIndex":200,"stage":"in_review","status":"completed","tags":[],"title":"Integration test: agent worktree visibility","updatedAt":"2026-01-30T23:55:27.727Z"},"type":"workitem"}
{"data":{"assignee":"@AGENT","createdAt":"2026-01-30T00:20:47.209Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Docs and runbook for the agent skill: usage, troubleshooting, CI instructions, and a GH issue template for reporting Worklog core gaps discovered by tests.\n\nDeliverables:\n- docs/agents-worktrees.md\n- docs/runbook-agent-conflicts.md\n- docs/ISSUE_TEMPLATES/agent-worktree-bug.md\n\n## Acceptance Criteria\n-  explains how to invoke the agent skill, expected outputs, and examples for local and CI runs.\n-  contains triage steps, what logs to collect, and reproduction steps to attach to a GH issue.\n- GH issue template exists and includes required fields: steps to reproduce, logs, expected vs actual behavior, and attachments.\n- Documentation includes a short checklist for PR reviewers to run the integration harness locally.","effort":"","id":"SA-0ML0507OP1JSRKEU","issueType":"task","parentId":"SA-0MKXYO42T0FC6IJR","priority":"low","risk":"","sortIndex":300,"stage":"in_progress","status":"deleted","tags":[],"title":"Docs & runbook: agent worktrees and triage","updatedAt":"2026-01-31T00:11:48.923Z"},"type":"workitem"}
{"data":{"assignee":"@patch","createdAt":"2026-02-01T23:54:08.113Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Formalize detection & blocking rules, CLI behaviour, and permissions.\n\nScope: Document `allowed_files` format, blocking algorithm (priority -> createdAt), CLI reporting, and WL permissions.\n\nSuccess Criteria:\n- `command/plan.md` contains the spec with examples for overlaps and expected CLI output.\n- Edge-case decision table reviewed by PM/Map.\n- Acceptance tests defined.\n\nDeliverables: updated `command/plan.md`, example CLI report snippets, acceptance test matrix.\n\n---\\n\\nAcceptance criteria ownership (delegation)\\n\\n- Detection implementation, integration tests, and CLI reporting/idempotence are implemented and validated in the child epic: Detection Engine — SA-0ML4EE9NH05OG9TI.\\n- Dependency recording and WL mutation integration are implemented and validated in: Dependency Recording — SA-0ML4EE9SQ1I39EZ3.\\n- Idempotence & Reporting responsibilities (reporting, no-op re-runs) are covered by: Idempotence & Reporting — SA-0ML4EE9X61I5IPEE.\\n\\nThese child epics are authoritative owners for acceptance criteria items 2–5; parent SA-0ML4EDHTD09ZZD7Y retains spec and design ownership.\\n---","effort":"","id":"SA-0ML4EDHTD09ZZD7Y","issueType":"epic","parentId":"SA-0MKXVTHF70EXG01D","priority":"high","risk":"","sortIndex":100,"stage":"in_review","status":"completed","tags":["milestone"],"title":"Spec & Design","updatedAt":"2026-02-02T05:25:29.264Z"},"type":"workitem"}
{"data":{"assignee":"@AGENT","createdAt":"2026-02-01T23:54:44.189Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Implement exact-path overlap detection and unit tests. Requires DB field to store allowed_files and CLI command(s) to author/validate allowed_files.\n\nScope: Parser for allowed_files, exact-path comparison among sibling tasks, tie-breaker logic (priority->createdAt), and unit test coverage.\n\nSuccess Criteria:\n- Unit tests assert correct detection and tie-breaking.\n- Detection logic exposed as a testable module/API.\n- DB schema changes or migration plan described and validated in tests.\n- CLI command prototype exists and is covered by unit tests.\n\nDeliverables: detection module, unit tests, DB migration plan/schema diff, CLI command prototype.","effort":"","id":"SA-0ML4EE9NH05OG9TI","issueType":"epic","parentId":"SA-0MKXVTHF70EXG01D","priority":"high","risk":"","sortIndex":200,"stage":"in_progress","status":"in_progress","tags":["milestone"],"title":"Detection Engine","updatedAt":"2026-02-03T03:47:35.174Z"},"type":"workitem"}
{"data":{"assignee":"Build","createdAt":"2026-02-01T23:54:44.378Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Implement WL integration to record wl dep edges, post comments, and update status/tags. Requires DB field for dependency metadata and a CLI command wrapper to apply/reverse dependency edges.\n\nScope: For each detected overlap determine blocker, run wl dep <blocker> <blocked>, post Blocks:/Blocked-by: comments, set status=blocked and blocked tag, and handle permission/error cases.\n\nSuccess Criteria:\n- Integration code issues correct wl invocations (mocked for tests).\n- Comments follow the agreed string format.\n- DB field for dependency metadata specified and mocked in integration tests.\n- New CLI command for dependency recording exists and is exercised in tests.\n\nDeliverables: implementation, integration tests, DB migration for dependency metadata, CLI command or stub.","effort":"","id":"SA-0ML4EE9SQ1I39EZ3","issueType":"epic","parentId":"SA-0MKXVTHF70EXG01D","priority":"high","risk":"","sortIndex":300,"stage":"in_progress","status":"open","tags":["milestone"],"title":"Dependency Recording","updatedAt":"2026-02-03T01:45:28.570Z"},"type":"workitem"}
{"data":{"assignee":"Build","createdAt":"2026-02-01T23:54:44.538Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Ensure repeated runs are no-ops and produce deterministic CLI reports.\n\nScope: Detect existing deps/comments/status/tags to avoid duplicates; generate deterministic report listing actions or 'no changes'.\n\nSuccess Criteria:\n- Re-running /plan with no changes returns 'no changes' and performs no new wl operations.\n- Report includes created deps, updated items, short titles, and suggested remediation.\n\nDeliverables: idempotence tests, CLI report formatter.","effort":"","id":"SA-0ML4EE9X61I5IPEE","issueType":"epic","parentId":"SA-0MKXVTHF70EXG01D","priority":"high","risk":"","sortIndex":400,"stage":"","status":"open","tags":["milestone"],"title":"Idempotence & Reporting","updatedAt":"2026-02-01T23:54:44.538Z"},"type":"workitem"}
{"data":{"assignee":"Build","createdAt":"2026-02-01T23:54:44.706Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Validate end-to-end behaviour with sample epics and tasks.\n\nScope: Create test epics (3+ sibling tasks with overlaps), run /plan end-to-end, assert deps/comments/status updates, and check cross-epic reporting vs auto-blocking.\n\nSuccess Criteria:\n- End-to-end tests demonstrate correct blocking and idempotence.\n- Cross-epic overlaps are reported (not auto-blocked).\n\nDeliverables: integration test scripts, sample test epics, test logs.","effort":"","id":"SA-0ML4EEA1U1FNKN7E","issueType":"epic","parentId":"SA-0MKXVTHF70EXG01D","priority":"high","risk":"","sortIndex":500,"stage":"","status":"open","tags":["milestone"],"title":"Integration Tests","updatedAt":"2026-02-01T23:54:44.706Z"},"type":"workitem"}
{"data":{"assignee":"Build","createdAt":"2026-02-01T23:54:44.874Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Publish authoring docs, task templates, and a triage runbook.\n\nScope: Update command/plan.md and command/intake.md, add task template that includes allowed_files, and a triage checklist.\n\nSuccess Criteria:\n- Docs include examples and remediation guidance.\n- Task templates available for PMs/plan authors.\n\nDeliverables: docs updates, templates, release notes/changelog entry.","effort":"","id":"SA-0ML4EEA6I13ZXT7F","issueType":"epic","parentId":"SA-0MKXVTHF70EXG01D","priority":"high","risk":"","sortIndex":600,"stage":"","status":"open","tags":["milestone"],"title":"Docs, Templates & Rollout","updatedAt":"2026-02-01T23:54:44.874Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-02T16:33:11.048Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary:\nDesign, define, and build an Automated PM Agent (APMA) that acts as a discovery, definition, and delegation engine to coordinate delivery across human and automated sub-agents. The APMA's responsibility is to ensure clarity of plan, break down work into actionable tasks, assign or delegate those tasks, and monitor progress — it does not implement code changes or directly modify repositories.\n\nGoal / Scope:\nThe APMA intake flow accepts briefs and performs discovery to surface candidate work, creates clear work definitions (analysis, design, implementation spec, test plan, docs), and delegates those tasks to appropriate agents or teams. It sequences and coordinates work, triggers or requests non-destructive checks (builds/tests in read-only mode), and reports status, risks, and blockers. All code or repository modifications are executed by delegated agents (people or automation) under explicit approval policies.\n\nUser stories:\n- As a product lead, I want the APMA to turn a high-level brief into a clear plan with defined tasks and assignees so work can start without ambiguous follow-ups.\n- As an engineer or sub-agent, I want the APMA to produce unambiguous child work-items (analysis, design spec, implementation spec, tests, docs) with acceptance criteria so I can execute my assigned work with minimal additional discovery.\n- As a stakeholder, I want the APMA to delegate work to named agents, maintain an audit trail of delegation actions, and produce regular progress reports so I can monitor delivery.\n- As a safety officer, I want the APMA to default to read-only discovery and never perform destructive repo operations without explicit separate approval.\n\nExpected behaviour / outcomes:\n- The APMA discovers and ranks candidate items from `idea` stage, runs readiness checks, and returns a clear recommended plan with proposed child tasks and suggested assignees/agent-groups.\n- The APMA can create draft child work-items or add delegation comments in `wl` to record what should be done and who should do it; it may assign tasks to agent identities but will not perform repository pushes, merges, or direct code edits.\n- The APMA coordinates non-destructive operations (CI runs in dry-run mode, linting, static analysis) and attaches results to work-items; any mutating repository actions are delegated and require separate approvals.\n- The APMA generates progress summaries (open/blocked items, percent complete, top risks) and maintains an auditable comment trail for decisions and delegations.\n- The APMA can also generate new ideas for exploration (research spikes, prototypes, alternative approaches) and surface them as candidate `idea`-stage work-items for further discovery.\n- The APMA can respond clearly about the status of any particular work-item or group of work-items, providing current stage, recent activity, assigned agents, blockers, and next recommended actions.\n\nAcceptance criteria:\n1) Given a project brief, the APMA creates an epic with child work-items that define discovery tasks, analysis, design, implementation spec, testing, and documentation steps with measurable acceptance criteria in `wl`.\n2) The APMA can produce a delegation plan for a selected work-item: a list of proposed child tasks, suggested assignee agent-groups, and the rationale for each delegation (verify: `wl show` and comments reflect proposed tasks and rationale).\n3) The APMA provides read-only discovery by default; `propose` or `delegate` actions create draft child work-items or comments but do not modify code repositories. Any `apply` mode that triggers repository changes must be explicitly approved and executed by delegated agents.\n4) The APMA produces human-readable progress reports and an audit trail of delegation actions attached to the relevant work-items.\n\nSuggested implementation approach:\n- Phase 1 (define): Create PRD, agent responsibilities, safety/permission model, and minimal architecture (core controller + plug-in subagents for wl, delegation, reporting).\n- Phase 2 (MVP): Implement intake parser, discovery scorer, task composer, delegation planner (creates draft child work-items and comments), and reporting module. Keep all repo-affecting steps as outputs for delegated agents.\n- Phase 3 (operate): Integrate with sub-agents (analysis-agent, design-agent, dev-agent, test-agent), refine delegation mappings, and add audit and reporting enhancements.\n\nDeliverables:\n- PRD and design doc stored in the repo describing discovery/definition/delegation model and safety policy.\n- APMA components (service/CLI) that implement the MVP acceptance criteria above, but do not perform direct repository mutations.\n- Tests validating `wl` creations, proposed delegations, and reporting behavior.\n\nNotes / constraints:\n- APMA is non-destructive by default: repository changes are outside its remit and must be performed by delegates under separate approvals.\n- Follow repo conventions for task naming, branch suggestions, and commit message drafts; these should be provided as outputs for delegates, not applied by APMA.\n- Maintain clear audit logs in work-items when delegations or proposals are created.\n\nAcceptance test steps:\n- Run APMA with a sample brief and verify an epic is created with well-defined child tasks: `wl show <epic-id>`.\n- Verify the APMA produced a delegation plan and comments suggesting assignees/agent-groups for child tasks.\n- Confirm APMA's operations did not perform any repository pushes or merges; repository-affecting steps are present as delegated outputs only.\n- Generate the APMA progress report and confirm it lists open/blocked items, percent complete, and top risks.\n\nRelated: SA-0ML5E7ZHH0Y5VJQE (select-next-intake-ready-item) and other skills that focus on discovery and delegation.","effort":"","id":"SA-0ML5E2A2V1YILTVR","issueType":"epic","parentId":null,"priority":"high","risk":"","sortIndex":200,"stage":"prd_complete","status":"in_progress","tags":[],"title":"Automated PM Agent — end-to-end project overseer","updatedAt":"2026-02-03T01:52:14.217Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-02T16:37:37.254Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary:\nCreate a reusable \"select-next-intake-ready-item\" skill that discovers and defines the next worklog item in the `idea` stage which should be advanced to `intake_complete`, and then delegates the resulting tasks to appropriate sub-agents for execution. This skill is part of the APMA's discovery and planning toolset: it focuses on surfacing ready work, producing clear task definitions, and assigning/delegating those tasks — the APMA coordinates delivery but does not perform the implementation work itself.\n\nGoal:\nProvide a deterministic, configurable function/skill that can search worklog (wl) for candidate items, run readiness checks, produce a structured task definition (including acceptance criteria and suggested subtasks), and recommend or delegate the item to one or more sub-agents (e.g., analysis-agent, design-agent, dev-agent, test-agent). The skill must support a read-only discovery mode and a delegation mode that creates the appropriate child work-items or adds delegation comments, but it must not modify code repositories directly.\n\nUser stories:\n- As the APMA, I want the skill to answer \"what should be moved from idea -> intake_complete next?\" and return a single work-item id plus a clear plan of what needs to be done and who should do it.\n- As an engineer or agent, I want the APMA to produce unambiguous child tasks (analysis, design spec, implementation spec, tests, docs) with acceptance criteria so I can act without extra discovery work.\n- As a stakeholder, I want the APMA to delegate tasks to the right sub-agents and provide a communication trail (work-item comments and assignments) so responsibility and progress are clear.\n- As a safety officer, I want the APMA to run in read-only mode by default and never perform destructive repository actions — delegation triggers agents who are responsible for code changes under human or delegated policy approvals.\n\nAcceptance criteria:\n1) The skill returns a JSON structure with: `id`, `score`, `rationale`, `checks` (list of passed/failed readiness checks), `proposed_tasks` (array of child task definitions), and `action` (suggested: `recommend` | `delegate`).\n2) The skill respects filters: only search `idea` stage, allow override tag filters, and allow minimum priority threshold.\n3) The skill supports `dry_run` (discovery-only), `propose` (creates draft child work-items in wl but does not assign or change stage), and `delegate` mode (creates/assigns child tasks to named agents or agent-groups; still read-only regarding repositories). Any state changes require explicit approval or delegate policy.\n4) The skill includes unit tests mocking `wl` outputs and verifying selection, task-definition, and delegation logic.\n\nImplementation notes:\n- Implement as a Python module under `tools/skills/select_next_intake.py` with a thin CLI and a function interface for other agents to call.\n- Data access uses `wl` for authoritative state (e.g. `wl list --stage idea --json`) but provide an injectable data-source abstraction for tests and simulations.\n- Output includes: readiness checks, scoring breakdown, proposed child tasks (title, description, acceptance criteria, suggested assignee/agent, priority), and a human-readable plan summary.\n- Scoring: start simple (priority weight, has_acceptance_criteria, has_assignee, no_open_blockers); expose weights in config.\n- Logging: structured logs and a short human-readable rationale; all delegation actions must record comments on work-items describing what was delegated and to whom.\n\nSKILL.md (first draft):\n\n---\n# select-next-intake-ready-item Skill\n\nPurpose\n- Discover the next worklog item in `idea` stage that is ready to move into intake and produce a clear, actionable plan that can be delegated to sub-agents. The skill focuses on discovery, definition, and delegation — the APMA coordinates work and ensures clarity, but does not directly modify code or repos.\n\nHow it works\n- Searches worklog for items in `idea` stage.\n- Runs readiness checks and computes a score.\n- Produces a set of proposed child tasks (analysis, design spec, implementation spec, tests, docs) with acceptance criteria and suggested agent(s).\n- Returns the top candidate and either recommends next steps or delegates the proposed tasks to named agents by creating wl child work-items and adding delegation comments.\n\nUsage\n\nCommand-line\n```\n# Dry-run (default): discovery-only, returns recommendation and proposed tasks\npython -m tools.skills.select_next_intake --dry-run\n\n# Propose: create draft child work-items in wl (no stage changes)\npython -m tools.skills.select_next_intake --propose --config config.yml\n\n# Delegate: create child work-items and assign them to sub-agents (requires --approve or delegate policy)\npython -m tools.skills.select_next_intake --delegate --assign-to analysis-agent,dev-agent --approve\n```\n\nAPI (Python)\n```\nfrom tools.skills.select_next_intake import select_next\n\nresult = select_next(mode='dry_run', filters={\"min_priority\":\"medium\"})\n# result => {\n#   \"id\": \"WL-123\",\n#   \"score\": 87,\n#   \"rationale\": \"High priority, has acceptance criteria, no blockers\",\n#   \"checks\": [ {\"name\":\"has_acceptance_criteria\",\"ok\":true}, ... ],\n#   \"proposed_tasks\": [ {\"title\":\"Analysis: scope & gaps\", \"assignee\":\"analysis-agent\", ... } ],\n#   \"action\": \"recommend\"\n# }\n```\n\nResult schema\n- id: string (work-item id)\n- score: integer (0-100)\n- rationale: short human-readable string\n- checks: array of {name, ok, details}\n- proposed_tasks: array of {title, description, acceptance_criteria, suggested_assignee_or_agent, priority}\n- action: `recommend` | `propose` | `delegate`\n\nConfiguration\n- Accepts JSON/YAML config to adjust scoring weights, filters, and delegation mapping (which tags map to which agent-groups).\n- Default weights: weight(priority)=0.5, weight(acceptance)=0.2, weight(assignee)=0.2, weight(blockers)=0.1\n\nSafety model\n- Default mode is `dry_run` (read-only).\n- `--propose` creates draft child work-items in `wl` but does not change the parent stage.\n- `--delegate` assigns tasks to agents and may add delegation comments; it never performs repository pushes/merges. Any repository actions are left to delegated agents and require separate approval.\n- All delegation actions are logged as comments on the parent work-item and child items, including timestamp, agent, mode, and rationale.\n\nTesting\n- Unit tests for scoring, checks, and proposed_tasks generation.\n- Integration tests mocking `wl` outputs to verify that `propose` and `delegate` modes create the expected child items and comments without touching repositories.\n\nOpen questions / TODOs\n- Finalize delegation mapping (tag -> agent-group) and default assignees.\n- Define how to detect and represent \"open blockers\" in wl (relationships, tags, or explicit blocker fields).\n- Define audit trail format for delegation actions and retention policy.\n\n---","effort":"","id":"SA-0ML5E7ZHH0Y5VJQE","issueType":"task","parentId":"SA-0ML5E2A2V1YILTVR","priority":"medium","risk":"","sortIndex":100,"stage":"","status":"open","tags":[],"title":"Skill: select-next-intake-ready-item","updatedAt":"2026-02-02T17:01:14.569Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-03T04:36:11.138Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Process for /plan conflict detection converted to WL CLI commands and helper work-items.\n\nSteps (converted to wl commands):\n1) Input: `epic_id`.\n2) Fetch siblings: run `wl show <epic_id> --children --json` to obtain canonical workitem JSONs. Each workitem must include an array `allowed_files` (list of exact paths).\n3) Normalize: ensure paths are normalized (posix, no trailing slashes) and ignore empty entries (client-side).\n4) Grouping: run the detection module `plan.detection.group_overlaps(children)` (local code) to build a path -> [workitems] map.\n5) For each path where multiple workitems reference it:\n   a) select `blocker_id` = `plan.detection.choose_blocker(items)` (highest `sortIndex`; tie -> earliest `createdAt`).\n   b) compute `blocked_ids` = items excluding `blocker_id`.\n   c) For each `blocked_id`: perform idempotence checks using dependency records + allowed_files:\n      - call `wl dep list <blocked_id> --json` and skip if an existing dep edge points to `blocker_id` and its recorded allowed_files already cover the overlapping paths.\n      - if the dep edge does not exist, or exists but does not include the new overlapping paths, proceed to create or update the dependency record and then add comments.\n   d) If not present, record the dependency via `wl dep add <blocked_id> <blocker_id> --json` and post comments:\n      - on blocked item: `wl comment add <blocked_id> --comment \"Blocked by <blocker_id> (paths: <comma-separated paths>)\" --json`\n      - on blocker item: `wl comment add <blocker_id> --comment \"Blocking <blocked_id> (paths: <comma-separated paths>)\" --json`\n   e) Optionally: set blocked item's status to `blocked` and add tag `blocked` via `wl update <blocked_id> --status blocked --tags \"+blocked\" --json` (ensure tag merging).\n6) Consolidated reporting: after all paths processed, post a summary comment on the epic: `wl comment add <epic_id> --comment \"Plan detection summary: <details>\" --json`, but only if not already present (use `wl comment list <epic_id> --json` and client-side exact match).\n7) Idempotence: all writes (deps/comments/status) are guarded by the above checks to avoid duplicates; re-running `/plan` must be a no-op when no new overlaps exist.\n8) Error handling & permissions: failures to write deps/comments must be reported as warnings in the epic comment; partial failures should be retried or surfaced as actionable errors.\n9) Tests and CI: provide unit tests that mock the WL CLI and exercise grouping, blocker selection, and idempotence. Provide an integration test that runs `/plan` twice and asserts no duplicate deps/comments.\n\nNew helper/CLI work items created to support the conversion:\n- SA-0ML6D6UJ21D9XTNU: Add dependency commands to wl CLI (dep-add/dep-list/dep-remove)\n\nComment formats (exact text used to detect duplicates):\n- Blocked comment: `Blocked by <blocker_id> (paths: <comma-separated paths>)`\n- Blocker comment: `Blocking <blocked_id> (paths: <comma-separated paths>)`\n- Epic summary: `Plan detection summary: <details>`\n\nNotes:\n- Uses exact-path matching only (no globs).\n- Multiple overlapping paths between the same pair should result in a single dep edge but multiple path entries in comments or a consolidated comment.\n- WL CLI helper commands may be extended to support `--json` and exact-match detection convenience operations.","effort":"","id":"SA-0ML63W2DD1NKSMXU","issueType":"task","parentId":"SA-0ML4EE9NH05OG9TI","priority":"high","risk":"","sortIndex":100,"stage":"in_progress","status":"in-progress","tags":[],"title":"Wire detection into /plan: idempotent dependency creation","updatedAt":"2026-02-04T07:02:06.224Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-03T04:45:39.544Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Add CLI options to set ordering when creating/updating work items: --sort-index <int> and --after <id>.","effort":"","id":"SA-0ML6488YF0PZMEYY","issueType":"task","parentId":null,"priority":"medium","risk":"","sortIndex":300,"stage":"","status":"open","tags":[],"title":"Add --sort-index and --after flags to wl create/update","updatedAt":"2026-02-03T04:45:39.544Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-03T04:47:58.674Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Ensure agents executing the /plan command can run required wl/git/test operations and have environment access. See comments for detailed steps and acceptance criteria.","effort":"","id":"SA-0ML64B8B50ZEM3QG","issueType":"task","parentId":"SA-0ML63W2DD1NKSMXU","priority":"high","risk":"","sortIndex":100,"stage":"","status":"deleted","tags":["agents"],"title":"Agent: prerequisites and permissions for /plan execution","updatedAt":"2026-02-03T08:49:57.988Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-03T06:29:48.651Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"When /plan detects overlapping allowed_files between sibling tasks, this task implements recording those conflicts in Worklog:\n\nSteps:\n1) Input: blocked_id, blocker_id, list of overlapping paths\n2) Ensure idempotence: skip if dep already exists or comments already posted\n3) Create dependency: \n4) Post comments:  on blocked;  on blocker. Consolidate multiple paths into one comment when loading multiple overlaps between the same pair.\n5) Optionally set blocked item's  to  and add  tag.\n6) Write unit tests for idempotence and integration tests exercising the complete flow.\n\nAcceptance criteria:\n- Runs idempotently (no duplicate deps/comments on re-run)\n- Creates dep edges and comments per accepted formats\n- Includes tests and docs","effort":"","id":"SA-0ML67Y6SR0HNZD1H","issueType":"task","parentId":"SA-0ML4EE9SQ1I39EZ3","priority":"high","risk":"","sortIndex":100,"stage":"","status":"open","tags":[],"title":"Record plan conflicts: create dependencies & comments","updatedAt":"2026-02-03T06:29:48.651Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-03T08:56:30.734Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Provide native `wl` subcommands to manage inter-workitem dependency edges. Implementation should add:\n\n- `wl dep add <from> <to>`: create a dependency edge from `<from>` (blocked) -> `<to>` (blocker)\n- `wl dep list <id> [--incoming|--outgoing]`: list dependencies for a work item\n- `wl dep remove <from> <to>`: remove an edge\n\nEnsure all commands support `--json` output and are idempotent (no-op if edge already exists/absent).\n\nAcceptance criteria:\n- Commands implemented and documented in `wl --help`\n- Unit tests for create/list/remove and idempotence\n- Commands integrate with `wl show <id> --json` outputs so other tools can inspect deps","effort":"","id":"SA-0ML6D6UJ21D9XTNU","issueType":"task","parentId":"SA-0ML63W2DD1NKSMXU","priority":"high","risk":"","sortIndex":200,"stage":"in_review","status":"completed","tags":[],"title":"Add dependency commands to wl CLI (dep-add/dep-list/dep-remove)","updatedAt":"2026-02-03T09:59:57.217Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-03T08:56:32.361Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Purpose\n\nProvide a concise, implementation-agnostic feature request: a read-only `wl` helper that allows tools (notably `/plan`) to determine whether a work item already contains a specific comment body. The focus of this request is WHAT the helper must do and WHY `/plan` needs it, not on low-level implementation details.\n\nGoals (What & Why)\n\n- Prevent duplicate informational comments (e.g. blocked/blocker/epic summary) so `/plan` can be idempotent when it posts automated comments.\n- Offer a clear, machine-oriented contract that other tools can call to ask: \"Does this work item already contain a comment with this content (or matching rule)?\"\n- Be safe: read-only behavior only — detection must never create or modify comments.\n- Be reliable across typical project sizes: callers should be able to depend on the helper for correctness even on work items with large numbers of comments.\n\nInputs (caller-provided)\n\n- Work item identifier (required).\n- Comment body to check for (required). Callers will provide the exact text they intend to post.\n- Optional scope hints (recommended): author identity, time window, or a matching mode preference (e.g. exact vs. whitespace-normalized). These are hints to narrow the search; callers must not rely on implicit normalization unless they request it.\n\nOutputs (behavioral contract)\n\n- A clear boolean indicator whether a matching comment exists.\n- When a match exists, return identifying information about the matched comment(s) (at minimum: comment id and author) so callers can reference the original instead of creating a duplicate.\n- Deterministic semantics: for a given input and matching mode the helper must consistently report the same result.\n- Error reporting: when read-permissions or transient failures prevent detection, return an explicit error state so callers can decide how to proceed.\n\nNon‑functional expectations\n\n- Read-only: the helper never creates, edits, or deletes comments.\n- Idempotence enablement: `/plan` and similar tools must be able to call the helper before attempting to post; a positive detection must be a reliable signal to skip posting.\n- Performance: the helper must remain usable on work items with many comments; callers expect reasonable latency for common cases (e.g. early-exit when a match is found) and clear error semantics for large-scale limits.\n- Auditability: the helper's responses must include enough information for callers to log or surface why a comment was not posted (e.g. matched comment id), without exposing sensitive data.\n\nAcceptance criteria (feature request)\n\n1. A documented `wl` command (or subcommand) exists that implements the read-only detection behavior described above. Documentation must specify the inputs, outputs, and error cases at a conceptual level.\n2. The helper provides a machine-readable result that indicates found/not-found and returns identifiers for any matches.\n3. Unit tests cover the core matching behaviours callers care about (exact match and at least one normalization mode) and demonstrate deterministic results.\n4. An integration test shows `/plan` can rely on the helper to avoid posting duplicate comments: run `/plan` twice against the same input and assert no duplicate comment is created.\n5. The helper gracefully reports permissions and transient errors so callers can decide to retry or surface an actionable warning.\n\nNotes / Non-prescriptive suggestions\n\n- Suggested command name (for discoverability): place the helper under the `comment` command group (e.g. `wl comment detect`), but the exact CLI surface is an implementation detail for the Worklog project.\n- Avoid hard-coding a single matching strategy: the helper should accept an explicit matching preference from callers rather than silently normalizing input by default.\n\nDeliverables\n\n- Feature implemented in `wl` with documentation describing the conceptual contract (inputs, outputs, error cases).\n- Tests (unit + integration) demonstrating correctness and that `/plan` remains idempotent when using the helper.","effort":"","id":"SA-0ML6D6VS81S14SH7","issueType":"task","parentId":"SA-0ML63W2DD1NKSMXU","priority":"high","risk":"","sortIndex":300,"stage":"done","status":"completed","tags":[],"title":"Add detect_existing_comment_exact helper to wl","updatedAt":"2026-02-03T10:13:26.751Z"},"type":"workitem"}
{"data":{"assignee":"@your-agent-name","createdAt":"2026-02-03T18:39:19.707Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"User requested analysis of process described in SA-0ML63W2DD1NKSMXU to determine if any wl commands are needed to enable an agent to complete the process. Must inspect wl available commands and ensure all work item CRUD steps are mapped to wl commands.","effort":"","id":"SA-0ML6Y0CRF0FLWWU3","issueType":"task","parentId":null,"priority":"medium","risk":"","sortIndex":400,"stage":"done","status":"completed","tags":[],"title":"Review SA-0ML63W2DD1NKSMXU process for needed wl commands","updatedAt":"2026-02-03T18:54:54.910Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-03T18:53:36.742Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Feature request: extend `wl dep list <itemId>` to support directional filtering. Current command returns both inbound and outbound edges, making it harder to perform idempotence checks for dependency creation. Request: add `--outgoing` to list only dependencies where <itemId> depends on others, and `--incoming` to list only dependencies where others depend on <itemId>.\n\nUser story:\nAs an agent, I want to query only outbound dependencies for a work item, so I can check whether a dependency edge already exists without additional client-side filtering.\n\nExpected behavior:\n- `wl dep list <itemId> --outgoing --json` returns only outbound edges (item depends on dependsOn).\n- `wl dep list <itemId> --incoming --json` returns only inbound edges (items that depend on item).\n- If neither flag is provided, retain current behavior (both directions).\n- If both flags are provided, either return an error or default to both (define explicitly; preference: error).\n- JSON output shape is unchanged aside from filtered contents.\n\nAcceptance criteria:\n- CLI help documents `--outgoing` and `--incoming` on `wl dep list`.\n- Filtering works in both human and `--json` output.\n- Unit tests cover outbound-only, inbound-only, and default behavior.\n- Backward compatibility: existing usage without flags continues to work.\n\nContext:\nNeeded for /plan idempotent dependency creation to avoid client-side filtering of dep list results.","effort":"","id":"SA-0ML6YIQ1Y11DAI64","issueType":"feature","parentId":"SA-0ML63W2DD1NKSMXU","priority":"medium","risk":"","sortIndex":500,"stage":"in_review","status":"completed","tags":[],"title":"Add --outgoing/--incoming filters to wl dep list","updatedAt":"2026-02-04T07:00:06.029Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-03T18:54:52.260Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Feature request: add a `--body` alias to `wl comment add` (and `wl comment create`) that maps to the existing `--comment` option. This improves ergonomics and aligns with other tooling conventions.\n\nUser story:\nAs an agent, I want to use `--body` when adding comments so that CLI usage is consistent with other systems and less error-prone.\n\nExpected behavior:\n- `wl comment add <workItemId> --body \"text\"` behaves exactly like `--comment \"text\"`.\n- If both `--body` and `--comment` are provided, return a clear validation error.\n- Help text documents `--body` as an alias for `--comment`.\n\nAcceptance criteria:\n- Alias works for `wl comment add` and `wl comment create`.\n- Help output lists `--body` in both commands.\n- Unit tests cover alias use and conflict error.\n- Backward compatibility: `--comment` continues to work unchanged.\n\nContext:\nReduces confusion when converting process docs that use `--body` by default.","effort":"","id":"SA-0ML6YKCBO0PV08BA","issueType":"feature","parentId":"SA-0ML63W2DD1NKSMXU","priority":"medium","risk":"","sortIndex":600,"stage":"done","status":"completed","tags":[],"title":"Add --body alias for wl comment add --comment","updatedAt":"2026-02-04T07:00:08.431Z"},"type":"workitem"}
{"data":{"assignee":"Map","createdAt":"2026-02-04T06:38:10.237Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Problem statement\nAMPA Daemon: a small Python-based containerized daemon that monitors LLM agent activity and notifies a Discord channel via webhook. In v1 it will send periodic heartbeat notifications (configurable interval) indicating the agent is alive.\n\nUsers\n- Operators running LLM agents on a single host who need lightweight visibility into agent liveness.\n- Agent orchestrators and PM agents that expect simple alive/heartbeat signals for monitoring and basic automation.\n\nExample user stories\n- As an operator, I want a container I can run on the LLM server that regularly posts an \"alive\" message so I can see the agent is running.\n- As an APMA integrator, I want the message to include the work-item id, hostname, and timestamp so I can correlate the signal with worklog items and hosts.\n\nSuccess criteria\n- Heartbeat messages are sent to the configured Discord webhook at the configured interval; default is 1 minute (env: AMPA_HEARTBEAT_MINUTES).\n- Messages include work-item id (if available), host name, and ISO-8601 timestamp.\n- The daemon reads webhook URL from env var `AMPA_DISCORD_WEBHOOK` and fails clearly if not set.\n- The service can be packaged in a container (Docker) and run with sensible defaults; logs are written to stdout/stderr for host/container logging.\n\nConstraints\n- V1 is read-only and only sends notifications; it does not modify repositories or create worklog items.\n- Runtime: Python (3.12+ recommended) in a container image; minimal dependencies.\n- Webhook URL must be supplied via env var `AMPA_DISCORD_WEBHOOK` (security: do not commit secrets).\n- Heartbeat interval must be configurable via env var `AMPA_HEARTBEAT_MINUTES` (integer minutes), default 1.\n- The container image and artifacts must be runnable with Podman (CLI-compatible with Docker); avoid Docker-only features that break Podman.\n\nExisting state\n- APMA PRD exists and describes an Automated PM Agent and related skills (see `docs/prd/PRD_Automated_PM_Agent_-_end-to-end_project_overseer_(SA-0ML5E2A2V1YILTVR).md`).\n- A related skill `select-next-intake-ready-item` exists as a design artifact and task (SA-0ML5E7ZHH0Y5VJQE) and shows how agents interact with wl.\n\nDesired change\n- Implement a minimal Python daemon that:\n  - Reads `AMPA_DISCORD_WEBHOOK` and `AMPA_HEARTBEAT_MINUTES` from environment.\n  - Posts a heartbeat message to the webhook at the configured interval.\n  - Supports a configurable message template that includes work-item id, hostname, and timestamp.\n  - Logs send attempts and failures to stdout with non-zero exit codes on fatal misconfiguration.\n  - Is containerized with a small Dockerfile and a recommended command to run; ensure the image and Dockerfile work with Podman (no Docker-only features).\n\nRelated work\n- docs/prd/PRD_Automated_PM_Agent_-_end-to-end_project_overseer_(SA-0ML5E2A2V1YILTVR).md — PRD describing APMA responsibilities and constraints; high-level context for AMPA Daemon.\n- skill/create-worktree-skill/SKILL.md — shows a pattern for agent worktrees and ephemeral agents.\n- tools/skills/select_next_intake.py (design) / SA-0ML5E7ZHH0Y5VJQE — related skill design that will consume or correlate with daemon signals in future.\n- .opencode/Workflow.md — repo workflow and safety model to follow.\n\nSuggested next step\n1) Build a minimal PoC container and run locally against a test Discord webhook. Steps:\n   - Implement `ampa_daemon.py` (Python) that uses `requests` to POST to the webhook.\n   - Add `Dockerfile` with `python:3.12-slim` base, expose no ports, run the daemon as the container CMD.\n   - Test locally with `AMPA_DISCORD_WEBHOOK` set to a test webhook and `AMPA_HEARTBEAT_MINUTES=1`.\n\nNotes / open questions (resolved)\n- Deployment runtime: target is an OCI-compatible container runtime on the server (Docker/Podman); images and run instructions must be compatible with Podman.\n- Completion notification: YES, include a completion notification capability in design, but mark it out-of-scope for MVP (implement in a later iteration).\n- Message format: use Discord embed format for notifications (structured embed payload).\n- Failure & retry policy: exponential backoff with up to 10 retry attempts on webhook failures; log each failed attempt and final failure.\n\nWork item id\nSA-0ML7NOSHP0MJC6HS","effort":"","id":"SA-0ML7NOSHP0MJC6HS","issueType":"task","parentId":"SA-0ML5E2A2V1YILTVR","priority":"medium","risk":"","sortIndex":500,"stage":"plan_complete","status":"in_progress","tags":[],"title":"AMPA Daemon: Discord heartbeat & notifier","updatedAt":"2026-02-04T06:55:29.906Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:53:16.039Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary: Merge the two workflow stages \"milestones_complete\" and \"plan_complete\" so they are a single stage. This requires merging the existing CLI commands /milestones and /plan so that /plan also defines milestones.\n\nUser story: As a release manager I want plan and milestones to be defined together so that creating a plan automatically captures milestones and we avoid duplicated workflow stages.\n\nExpected behaviour:\n- The system no longer uses separate stages  and ; instead a single stage  (or ) represents completion of planning and milestones.\n- The  command is extended to accept and persist milestone definitions (dates/labels/owners).\n- The  command is removed or deprecated and its functionality migrated into .\n\nAcceptance criteria:\n1. A single work item stage replaces both existing stages and is used in relevant workflows.\n2. The  command supports defining, listing, and updating milestones.\n3. Existing references/usages of  are updated to call the new  behaviour or appropriate migration shims are added.\n4. Tests updated/added to cover the combined behaviour.\n5. Documentation and CLI help updated to reflect the merged command and stage.\n\nImplementation notes and steps:\n1. Audit codebase for  and  command handlers and references (CLI, docs, workflows).\n2. Design the merged CLI interface and any required data model changes to support milestones within a plan.\n3. Implement  changes to accept milestone definitions (flags, config file, or subcommands), migrate  logic into .\n4. Add migration scripts or backwards-compatible aliases if needed.\n5. Update workflow stage names and any logic that checks for  or .\n6. Add/adjust unit and integration tests, update docs.\n\nFiles/areas likely affected: CLI command handlers for  and , workflow/state management code where stages are defined and used, tests, and documentation.\n\nNotes: The user typed  — I assume they meant . If that is incorrect please advise.","effort":"","id":"SA-0ML7O87EV0SD9ZP6","issueType":"task","parentId":null,"priority":"medium","risk":"","sortIndex":500,"stage":"","status":"open","tags":[],"title":"Merge milestones_complete and plan_complete stages: merge /milestones into /plan","updatedAt":"2026-02-04T06:53:16.039Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:53:24.734Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary: Merge the two workflow stages \"milestones_complete\" and \"plan_complete\" into a single stage and migrate the CLI functionality so `/plan` defines milestones.\n\nUser story: As a release manager I want planning and milestone definition to be a single step so that creating a plan also captures milestones and reduces duplicate workflow stages.\n\nExpected behaviour:\n- A single stage replaces both `milestones_complete` and `plan_complete` and is used consistently in workflows.\n- The `/plan` command is extended to accept and persist milestone definitions (labels, dates, owners).\n- The `/milestones` command is removed or deprecated and its functionality migrated into `/plan`.\n\nAcceptance criteria:\n1. Workflow stage `milestones_complete` is removed and replaced by a single `plan_complete` (or `milestones_and_plan_complete`) stage used everywhere.\n2. `/plan` supports creating/listing/updating milestones as part of the plan interface.\n3. References to `/milestones` updated to use `/plan` or a compatibility alias.\n4. Tests added/updated to cover the combined behaviour.\n5. CLI docs and help updated.\n\nImplementation steps:\n1. Locate CLI handlers and references for `/plan` and `/milestones`.\n2. Design merged CLI interface and any data model changes to store milestones within a plan.\n3. Implement `/plan` changes and migrate `/milestones` logic into it.\n4. Add migration shims or aliases if needed.\n5. Update workflow stage names and checks.\n6. Update tests and docs.\n\nNote: The user typed `/milesteons` in their request; I assumed they meant `/milestones`. If that's incorrect, please advise.","effort":"","id":"SA-0ML7O8E4E0VNWXY1","issueType":"task","parentId":null,"priority":"medium","risk":"","sortIndex":600,"stage":"","status":"open","tags":[],"title":"Merge milestones_complete and plan_complete stages: merge /milestones into /plan","updatedAt":"2026-02-04T06:53:24.734Z"},"type":"workitem"}
{"data":{"assignee":"@AGENT","createdAt":"2026-02-04T06:55:27.014Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Short Title: Core Heartbeat Sender\n\nSummary:\nPeriodic process that posts a heartbeat message (hostname + ISO-8601 timestamp, optional work-item id) to the Discord webhook defined in AMPA_DISCORD_WEBHOOK at interval AMPA_HEARTBEAT_MINUTES.\n\n## Acceptance Criteria\n- Heartbeat POSTs occur at the configured interval (default 1 minute) when AMPA_DISCORD_WEBHOOK is set.\n- Message payload includes hostname and ISO-8601 timestamp; includes work_item_id when available.\n- If AMPA_DISCORD_WEBHOOK is missing, the process exits with non-zero status and logs an explanatory error.\n- Unit tests verify message formatting and env-var handling.\n\nMinimal Implementation:\n- ampa_daemon.py reads env vars and builds the Discord webhook JSON payload (embed format). Uses requests.post to send.\n- Main loop sleeps for configured minutes (AMPA_HEARTBEAT_MINUTES) and sends heartbeat messages.\n- Logging to stdout/stderr using the logging module.\n\nEnv / Config:\n- AMPA_DISCORD_WEBHOOK (required)\n- AMPA_HEARTBEAT_MINUTES (integer, default 1)\n- AMPA_WORKITEM_ID (optional)\n\nDeliverables:\n- ampa_daemon.py, tests/test_message_format.py, README snippet for running with env vars.","effort":"","id":"SA-0ML7OB0H20XBQO6G","issueType":"","parentId":"SA-0ML7NOSHP0MJC6HS","priority":"medium","risk":"","sortIndex":100,"stage":"in_review","status":"completed","tags":[],"title":"Core Heartbeat Sender","updatedAt":"2026-02-04T07:44:51.908Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:55:27.262Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"SA-0ML7OB0NX0Z9T0YV","to":"SA-0ML7OB0H20XBQO6G"}],"description":"Short Title: Retry Policy & Backoff\n\nSummary:\nExponential-backoff retry policy for webhook POSTs, configurable via env vars, with detailed logging of attempts and eventual final-failure behavior.\n\n## Acceptance Criteria\n- On non-2xx response or network error the sender retries with exponential backoff up to configured max attempts (default 10).\n- Each retry is logged with attempt number and error; final failure is logged at ERROR level.\n- Unit tests simulate failures and assert retry attempts and backoff loop behavior (with mocked sleep).\n\nMinimal Implementation:\n- Implement retry loop in send_webhook() with config:\n  - AMPA_MAX_RETRIES (default 10)\n  - AMPA_BACKOFF_BASE_SECONDS (default 2)\n- Ensure backoff doubles each attempt; sleep calls can be mocked in tests.\n\nDependencies:\n- Depends on: Core Heartbeat Sender\n\nDeliverables:\n- Retry logic in ampa_daemon.py or utils/retries.py, tests under tests/test_retries.py.","effort":"","id":"SA-0ML7OB0NX0Z9T0YV","issueType":"","parentId":"SA-0ML7NOSHP0MJC6HS","priority":"P2","risk":"","sortIndex":200,"stage":"idea","status":"blocked","tags":[],"title":"Retry Policy & Backoff","updatedAt":"2026-02-04T06:58:32.496Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:55:27.487Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"SA-0ML7OB0U70BVLHF7","to":"SA-0ML7OB0NX0Z9T0YV"}],"description":"Short Title: Dead-letter Handling\n\nSummary:\nPersist final-failure information after exhausting retries: POST to AMPA_DEADLETTER_WEBHOOK if set, otherwise append to local dead-letter file AMPA_DEADLETTER_FILE.\n\n## Acceptance Criteria\n- After max retry attempts, if AMPA_DEADLETTER_WEBHOOK is set, POST the failure payload to it; otherwise append the failure JSON to AMPA_DEADLETTER_FILE (default /var/log/ampa_deadletter.log).\n- Final-failure attempts are logged at ERROR and include failure reason and original payload.\n- Unit tests verify fallback behavior: alternate webhook called when set; local file write when webhook absent (use temp file in tests).\n\nMinimal Implementation:\n- Implement dead_letter(payload) function that sends to alternate webhook if present else writes to file.\n\nEnv / Config:\n- AMPA_DEADLETTER_WEBHOOK (optional)\n- AMPA_DEADLETTER_FILE (default /var/log/ampa_deadletter.log)\n\nDependencies:\n- Depends on: Retry Policy & Backoff (and Core Heartbeat Sender)\n\nDeliverables:\n- dead_letter() implementation, integration-style test mocking webhook/file.","effort":"","id":"SA-0ML7OB0U70BVLHF7","issueType":"","parentId":"SA-0ML7NOSHP0MJC6HS","priority":"P2","risk":"","sortIndex":300,"stage":"idea","status":"blocked","tags":[],"title":"Dead-letter Final-failure Handling","updatedAt":"2026-02-04T06:58:32.661Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:55:27.687Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"SA-0ML7OB0ZR0W3CEVA","to":"SA-0ML7OB0H20XBQO6G"}],"description":"Short Title: Health & Observability\n\nSummary:\nExpose /health and Prometheus /metrics endpoints; record counters for sent/failed heartbeats and last heartbeat timestamp. Metrics port is configurable.\n\n## Acceptance Criteria\n- /health returns 200 when daemon is running and able to send; returns 503 if in a fatal misconfigured state (e.g., missing webhook).\n- /metrics exposes these metrics: ampa_heartbeat_sent_total, ampa_heartbeat_failure_total, ampa_last_heartbeat_timestamp_seconds.\n- Metrics are updated when heartbeats are sent or fail.\n- Integration test confirms /metrics and /health responses and metric presence.\n\nMinimal Implementation:\n- Use prometheus_client library and start_http_server(int(port)) with port configured via AMPA_METRICS_PORT (default 8000).\n- Implement a simple /health endpoint (e.g., using http.server or Flask) on the same port path /health.\n\nEnv / Config:\n- AMPA_METRICS_PORT (default 8000)\n\nDependencies:\n- Depends on: Core Heartbeat Sender\n\nDeliverables:\n- Metrics registration in code, simple HTTP handler for /health, tests, and README docs for scraping.","effort":"","id":"SA-0ML7OB0ZR0W3CEVA","issueType":"","parentId":"SA-0ML7NOSHP0MJC6HS","priority":"P2","risk":"","sortIndex":400,"stage":"idea","status":"blocked","tags":[],"title":"Health & Observability","updatedAt":"2026-02-04T06:58:32.847Z"},"type":"workitem"}
{"data":{"assignee":"@AGENT","createdAt":"2026-02-04T06:55:27.886Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"SA-0ML7OB15A0HU5NKZ","to":"SA-0ML7OB0H20XBQO6G"}],"description":"Short Title: Containerization & Run\n\nSummary:\nProvide a Podman-compatible container image (Dockerfile) from python:3.12-slim, non-root user, minimal deps, and clear run examples.\n\n## Acceptance Criteria\n- Image builds from python:3.12-slim and installs required deps (requests, prometheus_client, pytest as dev dep).\n- Image runs with podman run -e AMPA_DISCORD_WEBHOOK=... and writes logs to stdout/stderr.\n- README shows example podman build and podman run commands and non-root execution.\n\nMinimal Implementation:\n- Dockerfile with python:3.12-slim, create non-root user, COPY code, pip install -r requirements.txt, CMD [python,/opt/ampa/ampa_daemon.py].\n\nDependencies:\n- Depends on: Core Heartbeat Sender, Health & Observability\n\nDeliverables:\n- Dockerfile, requirements.txt, Makefile or build script, README run examples.","effort":"","id":"SA-0ML7OB15A0HU5NKZ","issueType":"","parentId":"SA-0ML7NOSHP0MJC6HS","priority":"P2","risk":"","sortIndex":500,"stage":"in_progress","status":"in_progress","tags":[],"title":"Containerization & Run Instructions","updatedAt":"2026-02-04T08:04:47.754Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:55:28.083Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"SA-0ML7OB1AR1IMJVFF","to":"SA-0ML7OB0H20XBQO6G"}],"description":"Short Title: Tests, CI, and Demo\n\nSummary:\nProvide unit tests, GitHub Actions workflow for running tests, and a demo script to validate end-to-end behavior against a test webhook.\n\n## Acceptance Criteria\n- pytest tests exist and pass locally.\n- CI workflow in .github/workflows/test.yml runs tests on push/PR without secrets.\n- scripts/demo_local.sh demonstrates running the container or script against a test webhook and verifies /metrics and /health endpoints.\n\nMinimal Implementation:\n- tests/ with unit tests: message formatting, retries, dead-letter fallback (use temp files/mocks), metrics increments.\n- .github/workflows/test.yml that sets up Python, installs deps, and runs pytest.\n- scripts/demo_local.sh that runs ampa_daemon.py with a test webhook and checks HTTP endpoints.\n\nDependencies:\n- Depends on: All code features (Core, Retry, Dead-letter, Observability)\n\nDeliverables:\n- tests/, .github/workflows/test.yml, scripts/demo_local.sh.","effort":"","id":"SA-0ML7OB1AR1IMJVFF","issueType":"","parentId":"SA-0ML7NOSHP0MJC6HS","priority":"P2","risk":"","sortIndex":600,"stage":"idea","status":"blocked","tags":[],"title":"Tests, CI, and Demo","updatedAt":"2026-02-04T06:58:33.185Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:55:28.315Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"SA-0ML7OB1H71YWK6OG","to":"SA-0ML7OB15A0HU5NKZ"}],"description":"Short Title: Docs & Runbook\n\nSummary:\nOperator-facing docs covering env vars, message format, failure handling, metrics, example run commands, and troubleshooting.\n\n## Acceptance Criteria\n- docs/ampa/README.md includes env var list, example payload, build/run steps, how to interpret metrics, and troubleshooting steps.\n- Links to PRD and related WL items are present for traceability.\n\nMinimal Implementation:\n- Create docs/ampa/README.md with env var table, sample payload, and runbook steps.\n\nDependencies:\n- Depends on: Containerization & Run\n\nDeliverables:\n- docs/ampa/README.md, sample webhook payload examples, troubleshooting checklist.","effort":"","id":"SA-0ML7OB1H71YWK6OG","issueType":"","parentId":"SA-0ML7NOSHP0MJC6HS","priority":"P2","risk":"","sortIndex":700,"stage":"idea","status":"blocked","tags":[],"title":"Documentation & Operator Runbook","updatedAt":"2026-02-04T06:58:33.350Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:59:06.579Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary:\nThe /plan command (or the agent that runs it) instructs using a `comments` subcommand on the worklog CLI to attach a \"Plan:\" changelog comment to the parent work item. An agent reported the following error while attempting this:\n\n\"Note about changelog comment: I attempted to add a Plan: changelog comment to the parent, but the worklog CLI variant on this machine did not accept the comments subcommand\"\n\nSteps to reproduce:\n1. Run the agent or execute the /plan flow that attempts to add a changelog/comment to the parent work item using a `wl comments ...` invocation.\n2. Observe the CLI error indicating the `comments` subcommand is unknown or unsupported on this machine.\n\nObserved behavior:\nThe agent fails to add the changelog comment and reports that the `comments` subcommand is not accepted by the local `wl` CLI.\n\nExpected behavior:\nThe /plan command should use a supported worklog CLI command to add comments (for example `wl comment add <work-item-id> --comment \"...\"`) or detect the available CLI variant and fall back to a compatible approach. The agent message should not instruct a command that is unsupported on the user's environment.\n\nSuggested implementation approach:\n- Update the /plan implementation to use the supported `wl comment add <id> --comment \"...\"` form (or the correct invocation for the installed wl binary).\n- Add runtime detection in the agent to check whether `wl comment` or `wl comments` is supported and choose the correct subcommand.\n- If comments cannot be added, fall back to creating a short child work item or include the changelog text in the plan output and clearly instruct the operator how to add it manually.\n- Update documentation and inline help to reflect the supported command form.\n\nAcceptance criteria:\n- The /plan flow no longer recommends or attempts the unsupported `wl comments` subcommand.\n- The agent successfully attaches the Plan/changelog comment to the parent work item on machines with the supported CLI or falls back gracefully.\n- Tests or a manual verification step demonstrating the corrected behavior are added.\n\nAgent output observed (quote):\n\"Note about changelog comment: I attempted to add a Plan: changelog comment to the parent, but the worklog CLI variant on this machine did not accept the comments subcommand\"\n\nAdditional context:\nThis is high priority because it affects agents' ability to add plan/changelog notes to work items, which is part of normal workflow automation.","effort":"","id":"SA-0ML7OFPW315B3LTA","issueType":"bug","parentId":null,"priority":"high","risk":"","sortIndex":700,"stage":"","status":"open","tags":[],"title":"Fix /plan command: incorrect commenting instructions for worklog CLI","updatedAt":"2026-02-04T06:59:06.579Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T06:59:18.536Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary:\nThe /plan command (or the agent that runs it) instructs using a `comments` subcommand on the worklog CLI to attach a \"Plan:\" changelog comment to the parent work item. An agent reported the following error while attempting this:\n\n\"Note about changelog comment: I attempted to add a Plan: changelog comment to the parent, but the worklog CLI variant on this machine did not accept the comments subcommand\"\n\nSteps to reproduce:\n1. Run the agent or execute the /plan flow that attempts to add a changelog/comment to the parent work item using a `wl comments ...` invocation.\n2. Observe the CLI error indicating the `comments` subcommand is unknown or unsupported on this machine.\n\nObserved behavior:\nThe agent fails to add the changelog comment and reports that the `comments` subcommand is not accepted by the local `wl` CLI.\n\nExpected behavior:\nThe /plan command should use a supported worklog CLI command to add comments (for example `wl comment add <work-item-id> --comment \"...\"`) or detect the available CLI variant and fall back to a compatible approach. The agent message should not instruct a command that is unsupported on the user's environment.\n\nSuggested implementation approach:\n- Update the /plan implementation to use the supported `wl comment add <id> --comment \"...\"` form (or the correct invocation for the installed wl binary).\n- Add runtime detection in the agent to check whether `wl comment` or `wl comments` is supported and choose the correct subcommand.\n- If comments cannot be added, fall back to creating a short child work item or include the changelog text in the plan output and clearly instruct the operator how to add it manually.\n- Update documentation and inline help to reflect the supported command form.\n\nAcceptance criteria:\n- The /plan flow no longer recommends or attempts the unsupported `wl comments` subcommand.\n- The agent successfully attaches the Plan/changelog comment to the parent work item on machines with the supported CLI or falls back gracefully.\n- Tests or a manual verification step demonstrating the corrected behavior are added.\n\nAgent output observed (quote):\n\"Note about changelog comment: I attempted to add a Plan: changelog comment to the parent, but the worklog CLI variant on this machine did not accept the comments subcommand\"\n\nAdditional context:\nThis is high priority because it affects agents' ability to add plan/changelog notes to work items, which is part of normal workflow automation.","effort":"","id":"SA-0ML7OFZ481CA747U","issueType":"bug","parentId":null,"priority":"high","risk":"","sortIndex":800,"stage":"","status":"deleted","tags":[],"title":"Fix /plan command: incorrect commenting instructions for worklog CLI","updatedAt":"2026-02-04T06:59:51.720Z"},"type":"workitem"}
{"data":{"assignee":"","createdAt":"2026-02-04T07:06:29.417Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[],"description":"Summary:\nThe agent currently marks the work-item as `done` or leaves it in an incorrect state after merging the PR produced by the `/implement` command. After a merge, the work-item should be updated to `completed` with its stage set to `in_review` and a comment added referencing the merge commit.\n\nUser story:\nAs an operator, when the agent finishes an `/implement` workflow and the PR is merged, I want the corresponding work-item to be marked `completed` and placed in the `in_review` stage so that downstream processes and reporting show the correct lifecycle state.\n\nExpected behaviour:\n- After the PR created by the `/implement` command is merged the agent must:\n  1) Update the work-item `status` to `completed`.\n  2) Update the work-item `stage` to `in_review`.\n  3) Add a comment on the work-item: \"Completed work, see merge commit <commit-hash> for details.\" (include actual merge commit hash).\n\nSteps to reproduce:\n1) Run the `/implement` command that creates a PR and an associated work-item.\n2) Merge the PR (via GitHub or local merge flow used by agents).\n3) Observe the work-item state; currently it may be marked `done` or remain in an incorrect state.\n\nSuggested implementation:\n- Locate the post-merge handler in the `/implement` agent flow and replace the current wl update call with:\n  `wl update <work-item-id> --status completed --stage in_review` and add the comment with the merge commit hash.\n- Add unit/integration test for the `/implement` flow that simulates a successful merge and asserts the final `status` and `stage` values and the presence of the comment.\n\nAcceptance criteria:\n- The agent updates work-item `status` to `completed` and `stage` to `in_review` after a successful merge.\n- A comment referencing the merge commit hash is added to the work-item.\n- Tests verify the behaviour and pass in CI.\n\nNotes:\n- Use `--json` or API calls where possible to avoid brittle text parsing.","effort":"","id":"SA-0ML7OP7L40QKWDB1","issueType":"bug","parentId":null,"priority":"high","risk":"","sortIndex":900,"stage":"","status":"open","tags":[],"title":"When wrapping up /implement command: mark work-item completed/in_review after merge","updatedAt":"2026-02-04T07:06:29.417Z"},"type":"workitem"}
{"data":{"assignee":"@AGENT","createdAt":"2026-02-04T07:45:09.146Z","createdBy":"","deleteReason":"","deletedBy":"","dependencies":[{"from":"SA-0ML7Q2XI11OO3S5I","to":"SA-0ML7OB15A0HU5NKZ"}],"description":"Summary:\nAdd a pluggable scheduling mechanism to the APMA daemon that defines which commands run, where they run (local host vs LLM server), and when they run. The scheduler must ensure only one command runs at a time, respect a global maximum run-frequency limit, and prefer commands that require an available LLM only when an LLM server is reachable.\n\nUser stories:\n- As an operator, I can register commands with fields (id, command, requires_llm, frequency_minutes, priority, metadata) so the daemon knows what to run and how often.\n- As the daemon, I will run at most one command at a time and will not start any command that requires an LLM unless an LLM server is available.\n- As the scheduler, I will select the next command based on how overdue it is relative to its requested frequency, weighted by a priority, to keep actual run times close to requested frequencies.\n\nExpected behaviour:\n- New command entries can be added/removed at runtime (hot reload or via config API).\n- Each command has: unique id, executable (shell string or defined action), requires_llm (bool), frequency_minutes (positive int), priority (integer or enum), last_run timestamp (nullable), and optional max_runtime_minutes.\n- The daemon enforces a global minimum interval between any command starts (\"max every x minutes\") configurable.\n- Only a single command can run concurrently.\n- Commands that require LLM are only scheduled when an LLM server is known available. The scheduler should re-evaluate availability periodically.\n\nDependency:\n- blocked-by:SA-0ML7OB15A0HU5NKZ\n\nSuggested implementation approach:\n- Add a persistent/serialisable schedule store (file or DB) that holds command definitions and last_run times.\n- Add a scheduler component that:\n  1) Polls every configurable short interval (eg. 30s) to decide if it should start a command.\n  2) Observes the global rate limiter (do not start if last_start < now - global_min_interval).\n  3) Computes a score for each eligible command and picks the command with the highest score.\n  4) Starts the command, marks it running, updates last_run when it finishes (success or failure) and records runtime and exit code.\n- Provide an LLM-availability probe used by the scheduler to mark LLM-required commands as temporarily ineligible.\n- Expose a lightweight API or CLI to list, add, remove, and adjust scheduled commands.\n\nAlgorithm suggestions (goal: keep each command close to its requested frequency):\n- Recommended algorithm: normalized-lateness weighted scheduler\n  - For each command i, compute:\n    - desired_interval = frequency_minutes_i * 60\n    - time_since_last = now - last_run_i (if never run, treat last_run as epoch 0 or large value to prioritize initial run)\n    - lateness = time_since_last - desired_interval\n    - normalized_lateness = lateness / desired_interval  (commands with normalized_lateness>0 are overdue)\n    - priority_factor = 1 + priority_weight * (priority_value)  (tuneable mapping, e.g. priority_value 0..10 => multiplier 1..2)\n    - score = max(normalized_lateness, 0) * priority_factor\n  - Pick the command with highest score among eligible commands. This balances proportional fairness (by frequency) and priority.\n  - Add aging: if a lower-priority command never runs, its normalized_lateness grows unbounded and it eventually wins, preventing starvation.\n\n- Alternative: proportional fair scheduling using ratio r = time_since_last / desired_interval, select highest r * priority_weight. Equivalent in practice to normalized-lateness for periodic scheduling.\n\n- Notes on tuning: clamp negative lateness to 0 to avoid favouring early runs; add a small epsilon to denominators to avoid division by zero. Map priority to a multiplicative factor rather than additive to preserve relative frequency desires.\n\nAcceptance criteria (measurable):\n- A wl work item or config file schema is added describing command fields and persisted store location.\n- Scheduler implemented with: store, eligibility checks (LLM availability & global rate limiter), selection algorithm, start/stop lifecycle, and metrics emitted for runs (start, finish, duration, exit code).\n- Automated unit tests for scheduler scoring including edge cases: never-run commands, very-high-frequency commands, LLM-required when unavailable, global rate limiter.\n- Integration test or simulation demonstrating that for a set of commands with varied frequencies and priorities, observed run times are within a reasonable bound (e.g. 10-20% average deviation) of requested frequencies over a simulated period.\n- Documentation: README or code comments describing the algorithm, configuration knobs (global_min_interval, poll_interval, priority mapping), and how to add/modify commands.\n\nWhat to deliver with this item:\n- Implementation branch, tests, and documentation.\n- Suggested tuning values and rationale for priority mapping.","effort":"","id":"SA-0ML7Q2XI11OO3S5I","issueType":"feature","parentId":"SA-0ML7NOSHP0MJC6HS","priority":"high","risk":"","sortIndex":800,"stage":"in_progress","status":"in_progress","tags":[],"title":"Add command scheduling mechanism to APMA daemon","updatedAt":"2026-02-04T08:04:17.503Z"},"type":"workitem"}
{"data":{"author":"effort_and_risk_skill","comment":"# Effort and Risk Report\n\nEffort     | Large   |  74.17h\nRisk       | High    |  13/20\nConfidence | 82%     |  unknowns: Exact location and conventions for new command wiring; Edge cases in output validation and error handling; Acceptance expectations for narrative formatting\n\n\n```json\n{\n  \"effort\": {\n    \"unit\": \"hours\",\n    \"tshirt\": \"L\",\n    \"o\": 43.0,\n    \"m\": 71.0,\n    \"p\": 118.0,\n    \"expected\": 74.17,\n    \"recommended\": 104.17,\n    \"range\": [\n      73.0,\n      148.0\n    ]\n  },\n  \"risk\": {\n    \"probability\": 3.1,\n    \"impact\": 4.14,\n    \"score\": 13,\n    \"level\": \"High\",\n    \"top_drivers\": [\n      \"TEST: Synthetic issue for effort_and_risk skill (synthetic)\",\n      \"TEST CHILD 1: part of SA-0MKT9O9AY002COU8\",\n      \"TEST CHILD 2: part of SA-0MKT9O9AY002COU8\"\n    ],\n    \"mitigations\": [\n      \"Add targeted tests and integration checks\",\n      \"Lock dependencies and add compatibility tests\",\n      \"Schedule extra review for risky components\"\n    ]\n  },\n  \"confidence_percent\": 82,\n  \"assumptions\": [\n    \"Existing skill framework and CLI plumbing can be reused\",\n    \"No major refactor of existing skills is required\",\n    \"Test harness can validate JSON output deterministically\"\n  ],\n  \"unknowns\": [\n    \"Exact location and conventions for new command wiring\",\n    \"Edge cases in output validation and error handling\",\n    \"Acceptance expectations for narrative formatting\"\n  ]\n}\n```","createdAt":"2026-01-25T06:34:56.421Z","id":"SA-C0MKTD649X0KE2JUQ","references":[],"workItemId":"SA-0MKSTQR3H1HLD7HC"},"type":"comment"}
{"data":{"author":"Map","comment":"Related child: SA-0MKXYO42T0FC6IJR — Agent worktrees / sync ref intake. Consider this a child work item for implementation planning.","createdAt":"2026-01-29T22:31:11.464Z","id":"SA-C0ML0139T31IHU9PQ","references":[],"workItemId":"SA-0MKXVC7NA0UQLDR7"},"type":"comment"}
{"data":{"author":"Map","comment":"Blocks: (none yet) - plan will create wl dep <blocking> <blocked> and add Blocks/Blocked-by comments; configured blocking rule: highest-priority sibling blocks others; blocked items set to status 'blocked'.","createdAt":"2026-02-01T09:25:25.622Z","id":"SA-C0ML3JCBUD064B6NM","references":[],"workItemId":"SA-0MKXVTHF70EXG01D"},"type":"comment"}
{"data":{"author":"Build","comment":"Milestones created/updated:\n- Spec & Design: SA-0ML4EDHTD09ZZD7Y (reused)\n- Detection Engine: SA-0ML4EE9NH05OG9TI (created)\n- Dependency Recording: SA-0ML4EE9SQ1I39EZ3 (created)\n- Idempotence & Reporting: SA-0ML4EE9X61I5IPEE (created)\n- Integration Tests: SA-0ML4EEA1U1FNKN7E (created)\n- Docs, Templates & Rollout: SA-0ML4EEA6I13ZXT7F (created)","createdAt":"2026-02-02T03:32:41.229Z","id":"SA-C0ML4M6JYL1Z0KQ9M","references":[],"workItemId":"SA-0MKXVTHF70EXG01D"},"type":"comment"}
{"data":{"author":"Map","comment":"Linked to parent orchestration epic SA-0MKXVC7NA0UQLDR7. Marking as child for implementation planning.","createdAt":"2026-01-29T22:31:20.229Z","id":"SA-C0ML013GKK0RO44E6","references":[],"workItemId":"SA-0MKXYO42T0FC6IJR"},"type":"comment"}
{"data":{"author":"OpenCode","comment":"Planning: created child work items for the agent skill, integration tests, and docs/runbook. Items: SA-0ML0502B21WHXDYA (feature), SA-0ML05054Q0S4KAUD (task), SA-0ML0507OP1JSRKEU (task). Next: run automated reviews and prepare final WL create commands for any remaining tasks. --agent: OpenCode","createdAt":"2026-01-30T00:20:56.352Z","id":"SA-C0ML050EQO1YSGYB2","references":[],"workItemId":"SA-0MKXYO42T0FC6IJR"},"type":"comment"}
{"data":{"author":"Map","comment":"Intake draft created at .opencode/tmp/intake-draft-Agent-policy-SA-0MKYE4BRF1U5WZLK.md. Next: review/approve draft so five intake reviews can run and then I will update work item description to the final brief.","createdAt":"2026-01-29T18:33:35.363Z","id":"SA-C0MKZSLPQB086NA4G","references":[],"workItemId":"SA-0MKYE4BRF1U5WZLK"},"type":"comment"}
{"data":{"author":"Map","comment":"Updated success criteria: existence of any open critical issue blocks creation/merge of any PR unless the PR explicitly closes a critical issue (and references its id).","createdAt":"2026-01-29T18:42:35.657Z","id":"SA-C0MKZSXAMH0ADKBGZ","references":[],"workItemId":"SA-0MKYE4BRF1U5WZLK"},"type":"comment"}
{"data":{"author":"Map","comment":"Removed the 'Suggested next steps' section from the draft per request.","createdAt":"2026-01-29T18:48:51.422Z","id":"SA-C0MKZT5CKD1VM27LW","references":[],"workItemId":"SA-0MKYE4BRF1U5WZLK"},"type":"comment"}
{"data":{"author":"Map","comment":"Plan: added skills for helper, PR creation, templates/runbook, owner inference, tests; added installer task SA-0MKZV9TXY1G4UGRS and features: SA-0MKZVA6LP07BA8QV SA-0MKZVA8AD1JXOYKI SA-0MKZVAA241KMKH45 SA-0MKZVABOH1I8OLXA SA-0MKZVAD4A119KO4I","createdAt":"2026-01-29T19:48:54.471Z","id":"SA-C0MKZVAKP21Y9BJW9","references":[],"workItemId":"SA-0MKYE4BRF1U5WZLK"},"type":"comment"}
{"data":{"author":"@AGENT","comment":"Added docs: docs/agents-worktrees.md, docs/runbook-agent-conflicts.md, docs/ISSUE_TEMPLATES/agent-worktree-bug.md. Created branch feature/SA-0ML0507OP1JSRKEU-docs and PR #6.","createdAt":"2026-01-30T23:56:43.140Z","id":"SA-C0ML1JL43O1IOQ46V","references":[],"workItemId":"SA-0ML0507OP1JSRKEU"},"type":"comment"}
{"data":{"author":"@patch","comment":"Implementation started: spec + initial tests added. Branch: feature/SA-0ML4EDHTD09ZZD7Y-implement. Next: implement detection module and integration tests.","createdAt":"2026-02-02T04:03:21.232Z","id":"SA-C0ML4N9ZPS1XZWVPV","references":[],"workItemId":"SA-0ML4EDHTD09ZZD7Y"},"type":"comment"}
{"data":{"author":"@patch","comment":"Created PR: https://github.com/SorraTheOrc/SorraAgents/pull/8 — adds spec + initial tests. Ready for review.","createdAt":"2026-02-02T04:03:39.840Z","id":"SA-C0ML4NAE2O18WES7A","references":[],"workItemId":"SA-0ML4EDHTD09ZZD7Y"},"type":"comment"}
{"data":{"author":"@patch","comment":"Reverted automated rewrite — restoring previous description. Apologies for removing important dependency information; I will now produce a conservative rewrite that preserves the original dependency graph details and acceptance criteria and present a diff for your approval.","createdAt":"2026-02-02T04:18:19.172Z","id":"SA-C0ML4NT8KK1HP7NKZ","references":[],"workItemId":"SA-0ML4EDHTD09ZZD7Y"},"type":"comment"}
{"data":{"author":"@patch","comment":"Acceptance criteria delegation: items 2–5 delegated to child epics: SA-0ML4EE9NH05OG9TI (Detection Engine), SA-0ML4EE9SQ1I39EZ3 (Dependency Recording), SA-0ML4EE9X61I5IPEE (Idempotence & Reporting). See PR #8 for spec + initial tests.","createdAt":"2026-02-02T05:01:57.692Z","id":"SA-C0ML4PDD1705NAYMD","references":[],"workItemId":"SA-0ML4EDHTD09ZZD7Y"},"type":"comment"}
{"data":{"author":"Build","comment":"Blocked pending WorkLog project work (detailed blockers & unblock criteria)\n\nWhy blocked:\n- This milestone requires new database schema changes to store `allowed_files` on tasks so the detection engine can read canonical file lists for siblings.\n- It also requires new CLI command(s) to author and validate `allowed_files` values (authoring UX + validation rules) that the detection code and CI/test harness will invoke.\n\nSpecific work needed (WorkLog project responsibilities):\n1) Provide and merge a DB migration that adds an `allowed_files` field (or suitable normalized table) to the task/work item model; publish the schema diff and migration plan (PR link).\n2) Deliver a CLI command (or API endpoint) to author/validate `allowed_files` values; provide the command name, usage, and any auth requirements.\n3) Ensure CI/test environments run the migration or provide a mocked DB hook for integration tests.\n4) Assign an owner for the DB/CLI deliverables and link the tracking work items in WorkLog.\n\nUnblock criteria (what to do to unblock this work item):\n- DB migration PR merged and deployed to test environments (provide migration ID and PR link).\n- CLI command implemented, published, and available to CI (provide command name and repo/PR link).\n- Unit tests for detection pass locally; integration tests able to read real/mocked `allowed_files` entries.\n- Comment on this work item with links to the migration PR and CLI PR/command, then set status back to `open` or `in-progress` and request `/plan` re-run.\n\nRelated parent: SA-0MKXVTHF70EXG01D (Swarmable Plans). See Spec & Design for expected formats and examples.","createdAt":"2026-02-02T03:49:30.199Z","id":"SA-C0ML4MS6HI1H10DGT","references":[],"workItemId":"SA-0ML4EE9NH05OG9TI"},"type":"comment"}
{"data":{"author":"@patch","comment":"Unblocked: Worklog team intake for a  command has been approved by the stakeholder. Proceeding with Detection Engine implementation (parser for , grouping, and selector by sortIndex). Remaining external work: DB migration to add  and CLI authoring/validation commands; coordinate with Worklog team and link PRs when available.","createdAt":"2026-02-02T05:24:25.196Z","id":"SA-C0ML4Q68RW1WJKV4W","references":[],"workItemId":"SA-0ML4EE9NH05OG9TI"},"type":"comment"}
{"data":{"author":"@patch","comment":"Per stakeholder request: reverting to blocked. Intake approved as problem statement only; do not treat this as an unblock for implementation. Work will remain blocked until DB/CLI deliverables are implemented and linked.","createdAt":"2026-02-02T05:25:05.647Z","id":"SA-C0ML4Q73ZJ1I1O6ZA","references":[],"workItemId":"SA-0ML4EE9NH05OG9TI"},"type":"comment"}
{"data":{"author":"@patch","comment":"Unblocked by WorkLog team:  commands and DB backend implemented. Marking this epic open. Please paste PR/migration links if available for traceability.","createdAt":"2026-02-03T01:45:28.382Z","id":"SA-C0ML5XSJ0E1M6M6IS","references":[],"workItemId":"SA-0ML4EE9NH05OG9TI"},"type":"comment"}
{"data":{"author":"@AGENT","comment":"Created detection module and unit tests; pushed branch feature/SA-0ML4EDHTD09ZZD7Y-implement and opened PR https://github.com/SorraTheOrc/SorraAgents/pull/9","createdAt":"2026-02-03T03:48:45.376Z","id":"SA-C0ML6272KG12SCQKG","references":[],"workItemId":"SA-0ML4EE9NH05OG9TI"},"type":"comment"}
{"data":{"author":"Build","comment":"Blocked pending WorkLog project work (detailed blockers & unblock criteria)\n\nWhy blocked:\n- This milestone requires a DB field to store dependency metadata and an approved CLI/interface for applying or reversing dependency edges (the automation needs a supported, auditable mechanism to create `wl dep` relations).\n- The WorkLog environment must provide either a CLI subcommand or an API the automation can call, and a service account or permission model to let the automation create dependencies and update statuses/comments.\n\nSpecific work needed (WorkLog project responsibilities):\n1) Provide and merge a DB migration adding a dependency metadata field (schema diff and migration PR). This field should record the automation's decision and metadata used for idempotence.\n2) Provide a CLI command or API for safely applying/reversing dependency edges, or approve a supported automation workflow (specifying required auth/service account).\n3) Clarify the expected comment format and permission boundaries (who may create deps/comments) and publish any required ACL changes.\n4) Assign an owner and link the WorkLog tracking items/PRs.\n\nUnblock criteria (what to do to unblock this work item):\n- DB migration PR merged and available in test environments.\n- CLI command or API available for dependency creation (provide command name or API endpoint + auth details) and tested in a staging environment.\n- Integration tests validate that the automation can create dependency edges and annotate work items without permission errors.\n- Comment on this work item with links to the migration and CLI/API PR(s) and required auth/setup, then set status back to `open` or `in-progress` and request `/plan` re-run.\n\nRelated parent: SA-0MKXVTHF70EXG01D (Swarmable Plans). See Dependency Recording milestone for expected behavior and comment formats.","createdAt":"2026-02-02T03:49:30.403Z","id":"SA-C0ML4MS6N70Z66ZHW","references":[],"workItemId":"SA-0ML4EE9SQ1I39EZ3"},"type":"comment"}
{"data":{"author":"@patch","comment":"Unblocked: Worklog team intake for a  command approved. Proceeding with Dependency Recording implementation (WL integration, comment format, idempotence). External requirements: dependency storage/migration and CLI/API for dep add/rm/list; will coordinate with Worklog team and link PRs when available.","createdAt":"2026-02-02T05:24:25.637Z","id":"SA-C0ML4Q69451EE8BOD","references":[],"workItemId":"SA-0ML4EE9SQ1I39EZ3"},"type":"comment"}
{"data":{"author":"@patch","comment":"Per stakeholder request: reverting to blocked. Intake approved as problem statement only; do not treat this as an unblock for implementation. Work will remain blocked until DB/CLI deliverables are implemented and linked.","createdAt":"2026-02-02T05:25:05.970Z","id":"SA-C0ML4Q748I0FOD9DM","references":[],"workItemId":"SA-0ML4EE9SQ1I39EZ3"},"type":"comment"}
{"data":{"author":"@patch","comment":"Unblocked by WorkLog team:  commands and DB backend implemented. Marking this epic open. Please paste PR/migration links if available for traceability.","createdAt":"2026-02-03T01:45:28.890Z","id":"SA-C0ML5XSJEH1OSQOD7","references":[],"workItemId":"SA-0ML4EE9SQ1I39EZ3"},"type":"comment"}
{"data":{"author":"@OpenCode","comment":"The PRD has been created/updated at: docs/prd/PRD_Automated_PM_Agent_-_end-to-end_project_overseer_(SA-0ML5E2A2V1YILTVR).md","createdAt":"2026-02-02T23:28:08.113Z","id":"SA-C0ML5SVWS00DW6OKT","references":[],"workItemId":"SA-0ML5E2A2V1YILTVR"},"type":"comment"}
{"data":{"author":"@AGENT","comment":"Full implementation plan and acceptance criteria:\\n1) Wire detection core to /plan using WLAdapter.list_children, group_overlaps, choose_blocker.\\n2) For each overlap group create dep edges and single-instance comments with idempotence guards (dep_list + detect_existing_comment_exact).\\n3) Add unit and integration tests mocking WLAdapter.\\n4) Document behavior in command/plan.md.\\n\\nAssignee/sortIndex: Set sortIndex to 250 (update API doesn't accept sort-index flag directly; request follow-up to set the field via admin or patch).","createdAt":"2026-02-03T04:36:21.840Z","id":"SA-C0ML63WAMO103KHZC","references":[],"workItemId":"SA-0ML63W2DD1NKSMXU"},"type":"comment"}
{"data":{"author":"@your-agent-name","comment":"Updated process to remove detect-existing-comment-exact and replace idempotence with dependency records + allowed_files checks. Also corrected comment examples to use wl comment add --comment.","createdAt":"2026-02-03T18:49:54.853Z","id":"SA-C0ML6YDYUD0WX8RU8","references":[],"workItemId":"SA-0ML63W2DD1NKSMXU"},"type":"comment"}
{"data":{"author":"@AGENT","comment":"Proposal:\\n- : set work item  explicitly on create/update.\\n- : insert new/updated item after work item ; implementation computes midpoint between  and the next sibling's  (or  if no next sibling).\\nImplementation notes:\\n- Validate integer input for .\\n-  should be resolved to numeric  before creating/updating work item; ensure atomic update to avoid races.\\n- Add unit tests for CLI parsing and sortIndex calculation, and integration tests that simulate concurrent inserts.\\n- Backwards-compatible: both flags optional; when omitted current behavior remains unchanged.\\n","createdAt":"2026-02-03T04:45:42.256Z","id":"SA-C0ML648B1S0DLXBAT","references":[],"workItemId":"SA-0ML6488YF0PZMEYY"},"type":"comment"}
{"data":{"author":"@AGENT","comment":"Agent prerequisites and permissions for  execution - checklist:\\n\\n1) CLI binaries: agent must have , usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system., and Work seamlessly with GitHub from the command line.\n\nUSAGE\n  gh <command> <subcommand> [flags]\n\nCORE COMMANDS\n  auth:          Authenticate gh and git with GitHub\n  browse:        Open repositories, issues, pull requests, and more in the browser\n  codespace:     Connect to and manage codespaces\n  gist:          Manage gists\n  issue:         Manage issues\n  org:           Manage organizations\n  pr:            Manage pull requests\n  project:       Work with GitHub Projects.\n  release:       Manage releases\n  repo:          Manage repositories\n\nGITHUB ACTIONS COMMANDS\n  cache:         Manage GitHub Actions caches\n  run:           View details about workflow runs\n  workflow:      View details about GitHub Actions workflows\n\nALIAS COMMANDS\n  co:            Alias for \"pr checkout\"\n\nADDITIONAL COMMANDS\n  agent-task:    Work with agent tasks (preview)\n  alias:         Create command shortcuts\n  api:           Make an authenticated GitHub API request\n  attestation:   Work with artifact attestations\n  completion:    Generate shell completion scripts\n  config:        Manage configuration for gh\n  copilot:       Run the GitHub Copilot CLI (preview)\n  extension:     Manage gh extensions\n  gpg-key:       Manage GPG keys\n  label:         Manage labels\n  preview:       Execute previews for gh features\n  ruleset:       View info about repo rulesets\n  search:        Search for repositories, issues, and pull requests\n  secret:        Manage GitHub secrets\n  ssh-key:       Manage SSH keys\n  status:        Print information about relevant issues, pull requests, and notifications across repositories\n  variable:      Manage GitHub Actions variables\n\nHELP TOPICS\n  accessibility: Learn about GitHub CLI's accessibility experiences\n  actions:       Learn about working with GitHub Actions\n  environment:   Environment variables that can be used with gh\n  exit-codes:    Exit codes used by gh\n  formatting:    Formatting options for JSON data exported from gh\n  mintty:        Information about using gh with MinTTY\n  reference:     A comprehensive reference of all gh commands\n\nFLAGS\n  --help      Show help for command\n  --version   Show gh version\n\nEXAMPLES\n  $ gh issue create\n  $ gh repo clone cli/cli\n  $ gh pr checkout 321\n\nLEARN MORE\n  Use `gh <command> <subcommand> --help` for more information about a command.\n  Read the manual at https://cli.github.com/manual\n  Learn about exit codes using `gh help exit-codes`\n  Learn about accessibility experiences using `gh help accessibility` available on PATH.\\n2) Authentication: agent must be able to run  authenticated (API token or local config) and usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system. creds for pushing branches and creating PRs if needed.\\n3) Worktree support: agent must be able to create/check-out branches and (optionally) worktrees.\\n4) File-system access: agent can read repo files and write commits in ephemeral worktree.\\n5) Test harness: agent can run ============================= test session starts ==============================\nplatform linux -- Python 3.10.12, pytest-9.0.2, pluggy-1.6.0\nrootdir: /home/rogardle/.config/opencode\nplugins: anyio-4.7.0\ncollected 5 items\n\ntests/test_detection.py ..                                               [ 40%]\ntests/test_detection_module.py ...                                       [100%]\n\n============================== 5 passed in 0.03s =============================== and has required test dependencies installed; CI mode may mock DB.\\n6) Environment variables: document required env vars (example: WL_API_TOKEN, GITHUB_TOKEN, CI=true).\\n7) Safe permissions: restrict destructive commands; ensure agent profile prevents system-level destructive cmd execution.\\n\\nAcceptance criteria:\\n- Add an  (or update existing docs) describing how to configure an agent to run .\\n- Integration test shows an agent run that executes  for a sample epic and creates  edges and comments.\\n- Unit tests for WLAdapter are included and run in CI.\\n\\nImplementation tasks:\\n- Update agent Dockerfile/base image to include , usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system., Work seamlessly with GitHub from the command line.\n\nUSAGE\n  gh <command> <subcommand> [flags]\n\nCORE COMMANDS\n  auth:          Authenticate gh and git with GitHub\n  browse:        Open repositories, issues, pull requests, and more in the browser\n  codespace:     Connect to and manage codespaces\n  gist:          Manage gists\n  issue:         Manage issues\n  org:           Manage organizations\n  pr:            Manage pull requests\n  project:       Work with GitHub Projects.\n  release:       Manage releases\n  repo:          Manage repositories\n\nGITHUB ACTIONS COMMANDS\n  cache:         Manage GitHub Actions caches\n  run:           View details about workflow runs\n  workflow:      View details about GitHub Actions workflows\n\nALIAS COMMANDS\n  co:            Alias for \"pr checkout\"\n\nADDITIONAL COMMANDS\n  agent-task:    Work with agent tasks (preview)\n  alias:         Create command shortcuts\n  api:           Make an authenticated GitHub API request\n  attestation:   Work with artifact attestations\n  completion:    Generate shell completion scripts\n  config:        Manage configuration for gh\n  copilot:       Run the GitHub Copilot CLI (preview)\n  extension:     Manage gh extensions\n  gpg-key:       Manage GPG keys\n  label:         Manage labels\n  preview:       Execute previews for gh features\n  ruleset:       View info about repo rulesets\n  search:        Search for repositories, issues, and pull requests\n  secret:        Manage GitHub secrets\n  ssh-key:       Manage SSH keys\n  status:        Print information about relevant issues, pull requests, and notifications across repositories\n  variable:      Manage GitHub Actions variables\n\nHELP TOPICS\n  accessibility: Learn about GitHub CLI's accessibility experiences\n  actions:       Learn about working with GitHub Actions\n  environment:   Environment variables that can be used with gh\n  exit-codes:    Exit codes used by gh\n  formatting:    Formatting options for JSON data exported from gh\n  mintty:        Information about using gh with MinTTY\n  reference:     A comprehensive reference of all gh commands\n\nFLAGS\n  --help      Show help for command\n  --version   Show gh version\n\nEXAMPLES\n  $ gh issue create\n  $ gh repo clone cli/cli\n  $ gh pr checkout 321\n\nLEARN MORE\n  Use `gh <command> <subcommand> --help` for more information about a command.\n  Read the manual at https://cli.github.com/manual\n  Learn about exit codes using `gh help exit-codes`\n  Learn about accessibility experiences using `gh help accessibility`, and ============================= test session starts ==============================\nplatform linux -- Python 3.10.12, pytest-9.0.2, pluggy-1.6.0\nrootdir: /home/rogardle/.config/opencode\nplugins: anyio-4.7.0\ncollected 5 items\n\ntests/test_detection.py ..                                               [ 40%]\ntests/test_detection_module.py ...                                       [100%]\n\n============================== 5 passed in 0.02s =============================== runtime deps (or document expected host config).\\n- Add agent startup check that validates required binaries and environment variables and fails fast with a clear error if misconfigured.\\n- Provide example env file and CI job snippet demonstrating how to run  under automation.\\n\\n","createdAt":"2026-02-03T04:48:03.632Z","id":"SA-C0ML64BC4W12ZPZB9","references":[],"workItemId":"SA-0ML64B8B50ZEM3QG"},"type":"comment"}
{"data":{"author":"@your-agent-name","comment":"Reviewed SA-0ML63W2DD1NKSMXU and wl --help. Missing/adjusted commands: (1) no wl detect-existing-comment-exact helper; must add a helper command or use wl comment list and client-side exact-match detection. (2) wl dep list has no --outgoing filter; must add filter support or parse full list client-side. (3) comment add uses --comment (not --body) so process should adjust. (4) tag merging not supported; wl update --tags replaces all tags, so need helper to merge or read existing tags then update with full set. Existing commands cover: wl show --children, wl dep add/rm, wl dep list, wl comment list/add, wl update for status/tags/stage.","createdAt":"2026-02-03T18:46:18.808Z","id":"SA-C0ML6Y9C541KF8QLX","references":[],"workItemId":"SA-0ML6Y0CRF0FLWWU3"},"type":"comment"}
{"data":{"author":"@AGENT","comment":"Created branch feature/SA-0ML7OB15A0HU5NKZ-containerize and opened PR: https://github.com/SorraTheOrc/SorraAgents/pull/11","createdAt":"2026-02-04T08:05:13.384Z","id":"SA-C0ML7QSQP309BP73W","references":[],"workItemId":"SA-0ML7OB15A0HU5NKZ"},"type":"comment"}
